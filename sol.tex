
% solutions for homeworks
\chapter{作业解答}

\section{第一次课}
% \subsection{1.1}
% \homework{
% 重温黑体辐射的历史，论述 Wien's formula 和 Rayleigh--Jeans formula 的
% 内在异同，以及 Planck 如何能利用``能量量子化''的概念，从 Rayleigh--Jeans
% formula 中得到 Planck blackbody radiation formula。
% }
\subsection{1.1}
\homework{
    重温黑体辐射的历史，论述Wien公式和Rayleigh--Jeans公式的内在异同。以及Planck如何利用能量量子化的概念，得到Planck黑体辐射公式。
}
Wien从热力学理论出发，把光辐射现象用分子的行为来类比，认为辐射按频率的分布类似于分子按速率的分布，因此服从Maxwell速率分布律。
在分析实验数据的基础上，他给出了一个关于黑体辐射光谱分布的公式
\begin{equation}\label{wien}
\rho(\nu,T) = C_1 \nu^3 \exp\qty(-\dfrac{C_2 \nu}{ T})
\end{equation}
其中$ C_1 $和$ C_2 $是经验参数，通过拟合实验曲线来确定。式\eqref{wien}称为Wien公式，这是一个半经验公式%，它的曲线如图1. 2 . ,1 所示
。
%进而求$ \rho(\lambda, T) $ 对$ \lambda $的导数：

对$ \lambda $积分得到辐射总能量
\begin{equation}
E(T) = \int_0^\infty C_1\nu^3 \exp\qty(-\dfrac{C_2 \nu}{ T}) \dd\nu \propto T^4
\end{equation}
这符合Stefan--Boltzmann定律。

Rayleigh和Jeans批评Wien在引入黑体辐射分布时的假设（辐射按频率的分布类似于分子按速率的分布）不可靠。
他们认为黑体辐射是由带电粒子的振动引起的，当系统处于热平衡状态时，振子数目按能量的分布服从Boltzmann公式
\begin{equation}
f(\varepsilon) = \dfrac{\exp\qty(-\dfrac{\varepsilon}{k_B T})}{\displaystyle\int_0^\infty \exp\qty(-\dfrac{\varepsilon}{k_B T}) \dd\varepsilon}
\end{equation}
由此得到振子的平均辐射能量为
\begin{equation}
\ev{\varepsilon} = \dfrac{\displaystyle\int_0^\infty \varepsilon \exp\qty(-\dfrac{\varepsilon}{k_B T}) \dd\varepsilon
}{\displaystyle\int_0^\infty \exp\qty(-\dfrac{\varepsilon}{k_B T}) \dd\varepsilon} = k_B T
\end{equation}
由振子密度
\begin{equation}
g(\nu) = \dfrac{8\pi\nu^2}{c^3}
\end{equation} 
得到黑体辐射的能量密度
\begin{equation}
\rho(\nu, T) = \dfrac{8\pi\nu^2}{c^3} k_B T
\end{equation}

这就是Rayleigh-Jeans公式。\\

将它们与实验相比较时，可以看出，Wien线可以描述短波情况，而在长波部分与实验有明显偏离；
而Rayleigh-Jeans线在长波部分与实验符合较好，但在短波部分与实验结果完全相反，它显示一种“紫外发散”。
%事实上容易估算，如果黑体辐射能量密度真的像瑞利－琼斯公式所预言的	那样，当人眼睛盯着壁炉里的火光时，火光的紫外线会刺瞎人的眼睛，这显然是荒	谬的。
%经典物理学面临一场“紫外灾难” 。
Wien分布是一个半经验公式，与实验不完全符合是可以理解的；
Rayleigh--Jeans公式是严格按照经典统计物理学理论和经典电磁场理论推导出来的，
然而它在短波部分与实验结果出现了极端尖锐的矛盾，这给物理学带来极大的困惑。

Planck试图寻求一个普遍适用的公式来刻画黑体辐射的光谱分布。
1900年，他发现如果取一个非常奇怪的假设，可以获得成功。
这个假设就是：黑体辐射的能量不是连续变化的，而是以$ h\nu $为单位一份一份进行的：
\begin{equation}
0, h\nu, 2h\nu, \cdots
\end{equation}
反映在计算中，就是将Rayleigh-Jeans公式推导中能量连续变化的积分，用分立变化的求和代替：
\begin{align}
\ev{\varepsilon} &= \dfrac{\displaystyle
    \sum_{n=0}^\infty n h \nu \exp\qty(-\dfrac{n h\nu}{k_B T})}{\displaystyle
    \sum_{n=0}^\infty \exp\qty(-\dfrac{n h\nu}{k_B T})} 
= \dfrac{\displaystyle
    \sum_{n=0}^\infty n h \nu \exp\qty(-n h\nu\beta)}{\displaystyle
    \sum_{n=0}^\infty \exp\qty(-n h\nu\beta)} \notag\\
&= -\pdv{\beta} \ln \qty[\sum_{n=0}^\infty \exp(-n h\nu\beta)]  \notag\\
&= -\pdv{\beta} \ln \qty[\dfrac{1}{1 - \exp(-h\nu\beta)}]\notag\\
&= \dfrac{h\nu}{\exp\qty(\dfrac{h\nu}{k_B T}) - 1}
\end{align}
\begin{equation}
\rho(\nu, T) = \dfrac{8\pi\nu^2}{c^3} \dfrac{h\nu}{\exp\qty(\dfrac{h\nu}{k_B T}) - 1}
\end{equation}

对于短波情况 $ h\nu \gg k_B T $，
\begin{equation}
\rho(\lambda, T) = \dfrac{8\pi h\nu^3}{c^3} \exp\qty(-\dfrac{h\nu}{k_B T})
\end{equation}
符合Wien公式；

对于长波情况 $ h\nu \ll k_B T $，
\begin{equation}
\rho(\lambda, T) = \dfrac{8\pi \nu^2}{c^3} k_B T
\end{equation}
符合Rayleigh--Jeans公式。

参考文献：顾樵 \S 1.2 、曾谨言 \S 1.1.1。
\subsection{1.2}
\homework{
    对于高斯波包
    \begin{align}
        \psi(x,t) = \int_{- \infty}^{+ \infty} \frac{\sqrt a}{(2\pi)^{3/4}} \exp\left[-\frac{a^2}4 (k-k_0)^2\right]\exp \big[ \ii \big( k x - \omega(k) t \big) \big] \, \mathrm{d} k,
    \end{align}
    证明 $t > 0$ 时，满足如下函数形式
    \begin{align}
        \psi (x, t) = \left( \frac{2}{\pi a^2} \right)^{1/4} \exp \left[ - \frac{(x - ct)^2}{a^2} \right] \exp [ \ii k_0 (x - ct) ].
    \end{align}
}

光波有
\begin{eqnarray}
    \omega = c k,
\end{eqnarray}
波包
\begin{align}
    \psi(x,t) = \frac{\sqrt a}{(2\pi)^{3/4}} \int_{- \infty}^{+ \infty} \exp\left[-\frac{a^2}4 (k-k_0)^2\right]\exp \big[ \ii k \big( x - c t \big) \big] \, \mathrm{d} k,
\end{align}
为了凑出傅里叶积分，令 $b \equiv \frac a2$、$l \equiv k-k_0$，有
\begin{align}
    \psi(x,0) & = \frac{\sqrt {2b}}{(2\pi)^{3/4}} \int_{- \infty}^{+ \infty} \exp\left(-b^2l^2\right) \, \exp \big[ \ii k ( x - c t ) \big] \, \notag\\ &\quad\quad \times\exp\big[ -\ii k_0 ( x - c t ) \big]\, \, \exp\big[ \ii k_0 ( x - c t ) \big] \,\mathrm{d} k \\
    &=\frac{\sqrt {2b}}{(2\pi)^{3/4}} \exp\big[\ii k_0 (x-ct)\big] \intinf 
    \exp\left(-b^2l^2\right) \, \exp\big[\ii l (x - c t)\big] \, \dd l,
\end{align}
令 $x - ct \equiv - 2\pi y$，则上式中的积分，可利用傅里叶变换得到
\begin{align}
    % \psi(y,0) = \frac{\sqrt {2b}}{(2\pi)^{3/4}} \exp\big[\ii k_0 (x-ct)\big] 
    \intinf 
    \exp\left(-b^2l^2\right) \, \exp(-\ii l \, 2 \pi y) \, \dd l = \frac{\sqrt \pi}b \exp \left(-\frac{\pi^2y^2}{b^2}\right),
\end{align}
因此，代回 $a$、$k$，可得结果。

注意到 $\ee^{\ii kx} = \cos kx + \ii \sin kx$，$x-ct$ 的正负不影响积分结果，虚部是奇函数，对称的积分区间导致虚部抵消了。
\begin{lstlisting}
Integrate[
    Sqrt[a]/(2 Pi)^(3/4)
        Exp[-a^2/4 (k - k0)^2] Exp[I (k x - c k t)], {k, -Infinity, 
        Infinity}, Assumptions -> {a > 0}]
>> (E^(((c t - x) (-I a^2 k0 - c t + x))/a^2) (2/\[Pi])^(1/4))/Sqrt[a]
\end{lstlisting}

\section{第二次课}

\subsection{2.1 (a)}
\homework{化简 $\hat B$，其满足
\begin{align}
    \hat A = \pdv{x} x, \quad \hat B = \hat A^2.
\end{align}
}
直接将 $\hat B$ 作用到波函数上，
\begin{align}
    \hat B \psi &= \hat A^2 \psi = \hat A \hat A \psi = \pdv{x}x \left(\pdv{x} x\psi\right) \\
    & = \pdv x x\left(x \pdv{\psi}{x} + \psi\right) = x^2 \pdv[2]{x} \psi + 3x \pdv{x}\psi + \psi,
\end{align}
因此
\begin{align}
    \hat B = x^2 \pdv[2]{x} + 3x \pdv{x} + 1.
\end{align}

\subsection{2.1(b)}
\homework{
    计算对易子
    \begin{align}
        \left[x^3, \pdv{x}\right], \quad \left[\pdv{x}, 5x^2 + 3x + 4\right].
    \end{align}
}
\begin{align}
    \left[x^3, \pdv{x}\right]f(x) &=
    x^3 \pdv{f(x)}{x} - \pdv{x} x^3 f(x) \\
    &= x^3 \pdv{f(x)}{x} - 3x^2 f(x) - x^3 \pdv{f(x)}x \\
    &= -3x^2 f(x)
\end{align}
\begin{align}
    &\phantom{=}\left[\pdv{x}, 5x^2 + 3x + 4\right] \\
    &= \pdv{x}(5x^2 + 3x + 4)f(x) - (5x^2 + 3x + 4) \pdv{x} f(x) \\
    &= (3+10x)f(x) + (5x^2 + 3x + 4) \pdv{f(x)}{x} - (5x^2 + 3x + 4) \pdv{x} f(x) \\
    &= (3+10x) f(x)
\end{align}
结果分别是 $-3x^2$ 和 $10x+3$。

注意算符不能悬空，必须作用到波函数上。
% 如果单独不作用到波函数上，
% 第二个对易式子就会得到
% \begin{align}
%     \pdv{x}(5x^2 + 3x + 4) - (5x^2 + 3x + 4) \pdv{x} = (10x+3) - (5x^2 + 3x + 4) \pdv{x}
% \end{align}
% 等错误结果。

\extraInfo{常见的错误证明}{用行内公式记号表述，即替代 $\frac{\partial}{\partial x}$ 为 $\partial_x$
\begin{align}
  \hat B &= \hat A^2 = (x \partial_x + 1)^2 \notag\\
  &= (x \partial_x)^2 + 2 x \partial_x + 1 \notag\\
  &\mathrel{\color{red}=} x^2 \partial_x^2 + 2 x \partial_x + 1
\end{align}
上式的证明中，红色等号是错误的。这是因为 $(x \partial_x)^2 = x \partial_x x \partial_x \neq x^2 \partial_x^2$。为了避免这种错误，才推荐在没有把握时，尽量在算符 $\hat B$ 后接函数 $\psi$ 进行分析。}

\suppInfo{纯算符推导}{
  上面的例子中，未必一定将 $\hat B \psi$ 才能给出 $\hat B$ 的形式。下面给出纯算符的证明方法。首先，知道
  \begin{equation}
    \partial_x x = x \partial_x + 1
  \end{equation}
  因此，
  \begin{align}
    \hat B = \hat A^2
    &= (\partial_x x) (\partial_x x) = (x \partial_x + 1) (x \partial_x + 1) \notag\\
    &= x \partial_x x \partial_x + 2 x \partial_x + 1 \notag\\
    &= x (\partial_x x) \partial_x + 2 x \partial_x + 1 \notag\\
    &= x (x \partial_x + 1) \partial_x + 2 x \partial_x + 1 \notag\\
    &= x x \partial_x \partial_x + 3 x \partial_x + 1 \notag\\
    &= x^2 \partial_x^2 + 3 x \partial_x + 1
  \end{align}
  结果正确，与不作用到波函数上的结果一致。
}

\subsection{2.2}
\homework{
    证明算符的左右分配律，

    左分配律 $(\BB + \CC) \AA = \BB\AA + \CC\AA$ 对任何算符成立，

    右分配律 $\AA (\BB + \CC) = \AA \BB + \AA\CC$ 仅对线性算符成立。
}
证明的关键是，仅当 $\AA$ 为线性算符时，根据定义才能得到
\begin{align}
    \AA \big(\BB \psi + \CC \psi) = \AA\BB \psi + \AA\CC \psi,
\end{align}
如果 $\AA$ 不是线性算符，这个等式不成立。

\textbf{证明} \quad 左分配律
\begin{align}
(\hat A + \hat B) \hat C \psi &= (\hat A + \hat B) (\hat C \psi) \notag\\
&= \hat A (\hat C \psi) + \hat B (\hat C \psi) \notag\\
&= (\hat A\hat C + \hat B \hat C) \psi
\end{align}
因此
\begin{equation}
(\hat A + \hat B) \hat C = \hat A \hat C + \hat B \hat C
\end{equation}
右分配律
\begin{align}
\hat A (\hat B + \hat C) \psi = \hat A (\hat B \psi + \hat C \psi)
\end{align}
\begin{equation}
(\hat A \hat B + \hat A \hat C) \psi = \hat A (\hat B \psi) + \hat A (\hat C \psi)
\end{equation}
若要满足
\begin{equation}
\hat A (\hat B + \hat C) \psi = (\hat A \hat B + \hat A \hat C) \psi
\end{equation}
则必须有
\begin{equation}
\hat A (\hat B \psi + \hat C \psi) = \hat A (\hat B \psi) + \hat A (\hat C \psi)
\end{equation}
这要求$ \hat A $为线性算符。

\subsection{2.3}
\homework{证明 $\hat p$、$\hat T$ 和 $\hat H$ 是厄米算符。}
对动量算符来说，证明其厄米性即
\begin{align}
    \langle{\phi|\hat{p}\psi}\rangle=\langle{\psi|\hat{p}\phi}\rangle^*,
\end{align}
左边
\begin{align}
    \langle{\phi|\hat{p}\psi}\rangle=\int{\phi^*\left(-\ii\hbar \frac{\partial\psi}{\partial x}\right)\dd x},
\end{align}
右边
\begin{align}
    \langle{\psi|\hat{p}\phi}\rangle^*&=\left[\int{\psi^*\left(-\ii\hbar \frac{\partial\phi}{\partial x}\right)\dd x}\right]^* \\
&=\int{\psi\left(\ii\hbar \frac{\partial\phi^*}{\partial x}\right)\dd x}\\
&=\ii\hbar \int{\psi\left(\frac{\partial\phi^*}{\partial x}\right)\dd x}\\
&=\ii\hbar \int \psi \dd\phi^*,
\end{align}
由分部积分公式 $\int u\dd v = uv - \int v\dd u$ 可知
\begin{align}
    \langle{\psi|\hat{p}\phi}\rangle^*=\phi^*\psi|_{-\infty}^{\infty}-\ii\hbar \int{\phi^*\left(\frac{\partial\psi}{\partial x}\right)\dd x},
\end{align}
根据品优波函数的条件，第一项为 0，那么显然左边等于右边。

动能算符 $\hat T = \hat p^2$ 同理。需证明
\begin{align}
    \langle\phi| \hat T\psi \rangle = \langle\psi|\hat T\phi\rangle^*,
\end{align}
即
\begin{align}
    \left\langle\phi\middle| \pdv[2]{x}\psi \right\rangle = \left\langle\psi\middle|\pdv[2]{x}\phi\right\rangle^*,
\end{align}
左边
\begin{align}
    \int \phi^* \pdv[2]{x} \psi \dd x = 
    \int \phi^* \dd \pdv{\psi}{x} =
    \underbrace{\int \phi^* \pdv{\psi}{x} \Big|_{-\infty}^{\infty}}_{=0} - \int \pdv{\psi}{x} \pdv{\phi^*}{x} \dd x,
\end{align}
右边
\begin{align}
    &\phantom{=}\left(\int\psi^* \pdv[2]{x}\phi\dd x\right)^* = \int \psi \pdv[2]{x}\phi^* \dd x \\
    &=\int \psi \dd \pdv{\phi^*}{x} = 
    \underbrace{\psi \pdv{\phi^*}{x} \Big|_{-\infty}^{\infty}}_{=0} - \int \pdv{\psi^*}{x} \pdv{\phi}{x} = \text{LHS}.
\end{align}

另有 \textbf{Dirac 符号}的证明方法。动量算符\begin{align}
	\Braket{\psi | \hat p | \psi} &= -i\hbar \Braket{\psi | \pdv{x} | \psi} \notag\\
	&= -i\hbar \qty[\psi^* \psi \Big|_{x=-\infty}^\infty - \Braket{\pdv{\psi}{x} | \psi} ] \notag\\
	&= i\hbar \Braket{\pdv{\psi}{x} | \psi}  \notag\\
	&= \Braket{\hat p \psi | \psi}
	\end{align}
动能算符
	\begin{align}
	\Braket{\psi | \hat T | \psi} &= -\dfrac{\hbar^2}{2m} \Braket{\psi | \pdv[2]{x} | \psi} \notag\\
	&= -\dfrac{\hbar^2}{2m} \qty[\psi^*\pdv{\psi}{x} \Bigg|_{x=-\infty}^\infty - \Braket{\pdv{\psi}{x} | \pdv{\psi}{x}}] \notag\\
	&= \dfrac{\hbar^2}{2m} \Braket{\pdv{\psi}{x} | \pdv{\psi}{x}}
	\end{align}
考虑
	\begin{align}
	\Braket{\pdv[2]{\psi}{x} | \psi} &= \pdv{\psi^*}{x}\psi \Big|_{x=-\infty}^\infty - \Braket{\pdv{\psi}{x} | \pdv{\psi}{x}} \notag\\
	&= - \Braket{\pdv{\psi}{x} | \pdv{\psi}{x}}
	\end{align}
所以
	\begin{align}
	\Braket{\psi | \hat T | \psi} &= -\dfrac{\hbar^2}{2m}\Braket{\pdv[2]{\psi}{x} | \psi} \notag\\
	&= \Braket{\hat T \psi | \psi}
	\end{align}
对于势能算符，如果 $V(x)$ 是实的，那么显然有
\begin{align}
    \langle\phi | V\psi\rangle = \int \phi* V \psi \dd x = \int (V \phi)^* \psi \dd x = \langle V\phi | \psi\rangle.
\end{align}
根据后一题的结论可知，$\hat H = \hat T + \hat V$ 两个 Hermite 算符的和也是 Hermite 的。

\subsection{2.4}
\homework{证明对于线性的 Hermitian 算符 $\hat A$ ，我们有
\begin{align}
    \int u^* \hat A v \,\dd \tau = \int (\hat A u)^* v\, \dd\tau,
\end{align}
同时，对于线性的 Hermitian 算符 $\hat A$、$\hat B$，具有以下性质：

a. $\hat A+\hat B$仍然是 Hermitian 算符

b. 当 $[\hat A, \hat B] = 0$时， $\AA\BB$ 和 $\BB\AA$ 仍是 Hermitian 算符。}
我们用 Dirac 记号简化证明过程。待证明的结论是
\begin{equation}
\langle u | \hat A u \rangle = \langle \hat A u | u \rangle \; \Rightarrow \; \langle f | \hat A g \rangle = \langle \hat A f | g \rangle
\end{equation}

对于任意的实变量复值域函数 $f, g$ 以及复数 $c$，令 $u = f + c g$，则
\begin{align}
\langle u | \hat A u \rangle
&= \langle f + c g | \hat A | f + c g \rangle \notag\\
&= \langle f | \hat A f \rangle + c \langle f | \hat A g \rangle + c^* \langle g | \hat A f \rangle + |c|^2 \langle g | \hat A g \rangle \\
= \langle \hat A u | u \rangle
&= \langle \hat A (f + c g) | f + c g \rangle \notag\\
&= \langle \hat A f | f \rangle + c \langle \hat A f | g \rangle + c^* \langle \hat A g | f \rangle + |c|^2 \langle \hat A g | g \rangle
\end{align}
由于 $\langle \hat A f | f \rangle = \langle f | \hat A f \rangle$，以及 $\langle \hat A g | g \rangle = \langle g | \hat A g \rangle$，因此上述等式化为
\begin{equation}
c \langle f | \hat A g \rangle + c^* \langle g | \hat A f \rangle
= c \langle \hat A f | g \rangle + c^* \langle \hat A g | f \rangle
\end{equation}
分别取 $c = 1, i$，可以得到
\begin{align}
\langle f | \hat A g \rangle + \langle g | \hat A f \rangle
&= \langle \hat A f | g \rangle + \langle \hat A g | f \rangle \\
\langle f | \hat A g \rangle - \langle g | \hat A f \rangle
&= \langle \hat A f | g \rangle - \langle \hat A g | f \rangle
\end{align}
将上两式等号左右相加，就得到 $\langle f | \hat A g \rangle = \langle \hat A f | g \rangle$。

参考资料：Griffiths，习题 3.3；徐光宪上册，\S 1.3.6。
\suppInfo{左矢与右矢记号补充说明}{
左矢的线性叠加会写成
\begin{equation}
| f + c g \rangle = | f \rangle + c | g \rangle
\end{equation}
右矢由于取了共轭，因此
\begin{equation}
\langle f + c g | = \langle f | + c^* \langle g |
\end{equation}
右矢中的常数 $c$ 也应当取共轭，这是容易忽视的。
}

Hermitian \textbf{算符和}
  \begin{align}
    \langle u | (\hat A + \hat B) u \rangle
    &= \langle u | \hat A u + \hat B u \rangle = \langle u | \hat A u \rangle + \langle u | \hat B u \rangle \notag\\
    &= \langle \hat A u | u \rangle + \langle \hat B u | u \rangle = \langle \hat A u + \hat B u | u \rangle \notag\\
    &= \langle (\hat A + \hat B) u | u \rangle
  \end{align}
  \begin{itemize}[nosep]
    \item 第 1, 5 等号是算符和的定义；
    \item 第 3 个等号应用了 $\hat A, \hat B$ 作为 Hermitian 算符的性质；
  \end{itemize}

Hermitian \textbf{算符积}
  \begin{align}
    \langle u | \hat A \hat B u \rangle = \langle u | \hat A (\hat B u) \rangle = \langle \hat A u | \hat B u \rangle = \langle \hat B (\hat A u) | u \rangle = \langle \hat B \hat A u | u \rangle
  \end{align}
  \begin{itemize}[nosep]
    \item 第 1、4 个等号是乘法结合律；
    \item 第 2、3 个等号应用了 $\hat A, \hat B$ 作为 Hermitian 算符的性质；
  \end{itemize}
  由于题目要求算符可对易，$\hat A \hat B = \hat B \hat A$ ，因此
  \begin{equation}
    \langle u | \hat A \hat B u \rangle = \langle \hat B \hat A u | u \rangle = \langle \hat A \hat B u | u \rangle
  \end{equation}

需要注意，若 $\hat A \hat B \neq \hat B \hat A$ 或者等价地，$[\hat A, \hat B] \neq 0$，那么一般来说 $\langle u | \hat A \hat B u \rangle \neq \langle \hat A \hat B u | u \rangle$。但即使如此，$\langle u | \hat A \hat B u \rangle = \langle \hat B \hat A u | u \rangle$ 仍然成立。

\subsection{3.5}
\homework{
    若 $\hat A, \hat B, \hat C$ 是线性算符，
  \begin{enumerate}[nosep]
    \item 若 $\hat A, \hat B$ 同时是 Hermitian 算符，那么 $\hat A \hat B + \hat B \hat A$ 与 $i (\hat A \hat B - \hat B \hat A)$ 是 Hermitian 算符；
    \item $[\hat A, \hat B \hat C] = \hat B [\hat A, \hat C] + [\hat A, \hat B] \hat C$；
    \item $[\hat A \hat B, \hat C] = \hat A [\hat B, \hat C] + [\hat A, \hat C] \hat B$；
    \item $[\hat A, [\hat B, \hat C]] + [\hat B, [\hat C, \hat A]] + [\hat C, [\hat A, \hat B]] = 0$ (Jacobi 恒等式)
  \end{enumerate}
}

1. 
上一题中，我们已经得到了结论 $\langle u | \hat A \hat B u \rangle = \langle \hat B \hat A u | u \rangle$，因此
  \begin{align}
    \langle u | (\hat A \hat B + \hat B \hat A) u \rangle
    &= \langle u | \hat A \hat B u \rangle + \langle u | \hat B \hat A u \rangle \notag\\
    &= \langle \hat B \hat A u | u \rangle + \langle \hat A \hat B u | u \rangle \notag\\
    &=  \langle (\hat A \hat B + \hat B \hat A) u | u \rangle
  \end{align}
  同时，
  \begin{equation}
    \langle u | i \hat A \hat B u \rangle
    = i \langle u | \hat A \hat B u \rangle
    = i \langle \hat B \hat A u | u \rangle
    = - \langle i \hat B \hat A u | u \rangle
  \end{equation}
  其中，最后一个等号是由于左矢的常数系数提出或放入时，需要作共轭。因此
  \begin{align}
    \langle u | i (\hat A \hat B - \hat B \hat A) u \rangle
    &= \langle u | i \hat A \hat B u \rangle - \langle u | i \hat B \hat A u \rangle \notag\\
    &= - \langle i \hat B \hat A u | u \rangle + \langle i \hat A \hat B u | u \rangle \notag\\
    &= \langle i (\hat A \hat B - \hat B \hat A) u | u \rangle
  \end{align}
  2.
  \begin{align}
    [\hat A, \hat B \hat C] f
    &= \hat A \hat B \hat C f - \hat B \hat C \hat A f \notag\\
    &= \hat A \hat B \hat C f - \hat B \hat A \hat C f + \hat B \hat A \hat C f - \hat B \hat C \hat A f \notag\\
    &= [\hat A, \hat B] \hat C f + \hat B [\hat A, \hat C] f
  \end{align}
  3.
  \begin{align}
    [\hat A \hat B, \hat C] f
    &= \hat A \hat B \hat C f - \hat C \hat A \hat B f \notag\\
    &= \hat A \hat B \hat C f - \hat A \hat C \hat B f + \hat A \hat C \hat B f - \hat C \hat A \hat B f \notag\\
    &= \hat A [\hat B, \hat C] f + [\hat A, \hat C] \hat B f
  \end{align}
  4.
  \begin{align}
    [\hat A, [\hat B, \hat C]] &= [\hat A, \hat B \hat C - \hat C \hat B] = [\hat A, \hat B \hat C] - [\hat A, \hat C \hat B] \notag\\
    &= \hat B [\hat A, \hat C] + [\hat A, \hat B] \hat C - \hat C [\hat A, \hat B] - [\hat A, \hat C] \hat B \notag\\
    &= (\hat B [\hat A, \hat C] - [\hat A, \hat C] \hat B) + ([\hat A, \hat B] \hat C - \hat C [\hat A, \hat B]) \notag\\
    &= [\hat B, [\hat A, \hat C]] + [[\hat A, \hat B], \hat C] \notag\\
    &= - [\hat B, [\hat C, \hat A]] - [\hat C, [\hat A, \hat B]]
  \end{align}
上式的证明中，利用到了对易子的加法结合律、以及自反性质 $[\hat A, \hat B] = - [\hat B,\hat A]$。

\subsection{2.6}
\homework{(a) 线性 Hermitian 算符的本征函数 $\{\psi_i\}$ 是正交归一的，
\begin{align}
    \begin{cases}
        \langle i|j \rangle = 1, \quad & i = j,\\
        \langle i|j \rangle = 0, \quad & i \neq j,
    \end{cases}
    \Rightarrow \delta_{ij},
\end{align}

(b) 若两个线性 Hermitian 算符有一个共同本征函数完备集，
\begin{align}
    \hat F \psi_i = f_i \psi_i, \quad \hat G \psi_i = g_i \psi_i,
\end{align}
则两个算符可以对易 $[\hat F, \hat G] = 0$，或者 $\hat F$ 或 $\hat G$ 可以同时测量。
}
第一问，设一 Hermite 算符 $\hat A$，有
\begin{align}
    \hat A |i\rangle = a_i |i\rangle, \quad \langle i | \hat A = a_i^* \langle i|,
\end{align}
由此可知
\begin{align}
    & \langle i |\hat A | j \rangle = a_j \langle i | j\rangle, \\
    & \langle i |\hat A j \rangle = \langle\hat A i | j \rangle = a^*_i  \langle i | j\rangle,
\end{align}
当 $i\neq j$ 时，因为 $a^*_i \neq a_j$，必然有 $\langle i | j\rangle = 0$。

当 $i = j$ 时，由波函数的品优性可知 $\langle i | i\rangle \neq 0$，所以 $a_i = a_i^*$，即 $\langle i | i\rangle = 1$。

因此 $\langle i | j \rangle = \delta_{ij}$。

第二问，直接计算对易子，有
\begin{align}
    [\hat F, \hat G] &= \hat F\hat G \psi_i - \hat G\hat F \psi_i \\
    &= \hat F g_i \psi_i - \hat G f_i \psi_i \\
    &= g_i \hat F \psi_i - f_i \hat G \psi_i \\
    &= g_i f_i \psi_i - f_i g_i \psi_i \\
    &= 0,
\end{align}
因此二者对易，即二者可以同时测量。


\section{第三次课}
\subsection{3.1}
\homework{对于给出下述初态 $\psi(x,t=0)$，即初始时刻自由粒子（$V(x) = 0$）波函数，求出 $\psi(x,t)$ 含时演化波函数，其中 $a>0, b\in\mathbb{R}, x\in\mathbb{R}$，

(a) $A \ee^{-a|x|}$, (b) $A\ee^{-ax^2}$, (c) $A \ee^{-ax^2} \ee^{-\ii b x}$. 
}
本题的求解思路是
\begin{align}
    \psi(x,0) \rightarrow A(k,0) \rightarrow A(k,t) \rightarrow \psi(x,t),
\end{align}
将 $t=0$ 的波函数变换到波矢 $k$ 表象，
\begin{align}
    &A(k,0) = \frac1{\sqrt{2\pi}} \intinf \psi(x,0) \, \ee^{-\ii k x} \, \dd x
\end{align}
波矢与坐标表象之间满足傅里叶变换关系。
对于自由粒子的含时演化，可直接由 $k$ 表象下求得，
\begin{align}
    &A(k,t) = A(k,0)\, \exp\left(-\frac{\ii E(k) t}\hbar\right), \\
    &\psi(x,t) = \frac{1}{\sqrt{2\pi}} \intinf A(k,t)\, \ee^{\ii kx} \, \dd k,
\end{align}
其中，粒子满足的波矢-能量关系式为
\begin{align}
    E(k) = \frac{\hbar k^2}{2m}. 
\end{align}

(a) 归一化
\begin{align}
    \int \psi \psi^* \dd x = \frac{A^2}a = 1,
\end{align}
解得 $A = \sqrt a$。
容易写出以下结果，
\begin{align}
    A(k,0) = \sqrt{\frac{a}{2\pi}} \intinf \ee^{-a|x|}\ee^{-\ii k x} \, \dd x = \sqrt{\frac{2a}\pi} \frac{a}{a^2 + k^2},
\end{align}
\begin{align}
    A(k,t) = \sqrt{\frac{2a}\pi} \frac{a}{a^2 + k^2} \exp \left( - \ii \frac{k^2}{2m} t\right),
\end{align}
\begin{align}
    \psi(x,t) = \frac{a^{3/2}}{\pi} \intinf \frac1{a^2 + k^2} \exp\left( \ii k x - \ii \frac{k^2}{2m} t\right) \dd k. 
\end{align}
该积分无法继续求解。

(b) 归一化
\begin{align}
    A^2 \sqrt{\pi/2a} = 1,
\end{align}
得到 $A = (2a/\pi)^{1/4}$.
\begin{align}
    A(k,0) = \frac{A}{\sqrt{2\pi}} \intinf \ee^{-a x^2} \ee^{-\ii k x}\, \dd x = \frac1{(2\pi a)^{1/4}} \exp\left(-\frac{k^2}{4a}\right). 
\end{align}
\begin{align}
    \psi(x,t) &= \frac{1}{\sqrt{2\pi}} \frac1{(2\pi a)^{1/4}} \intinf \exp\left(- \frac{k^2}{4a} - \ii \frac{k^2}{2m}t + \ii k x\right) \dd k \\
    &= \left(8\pi a\right)^{1/4} \frac1{\sqrt{1 + \frac{2\ii a t}{m}}} \exp\left(- \frac{ax^2}{1 + \frac{2\ii at}{m}}\right). 
\end{align}

(c) 归一化同 (b)，求出
\begin{align}
    A(k,0) = \frac1{(2a\pi)^{1/4}} \exp\left(-\frac{(b+k)^2}{4a}\right),
\end{align}
则含时波函数为
\begin{align}
    \psi(x,t) = (8\pi a)^{1/4} \frac1{\sqrt{1 + \frac{2\ii a t}{m}}} \exp\left(
        -\frac{ax^2 + \ii b x + \frac{\ii b^2 t}{2m}}
        {1 + \frac{2\ii a t}{m}}
    \right). 
\end{align}
参考资料：
Griffiths，\S 2.1 与 \S 2.4，习题 2.20。它讨论了离散谱、连续谱的波函数含时演化过程。我们的习题仅讨论了自由粒子连续谱的情况。离散谱的一个经典例子是半箱粒子 (Griffiths，习题 2.38)。

\subsection{3.2}
\homework{求以上两种情况的零点能，(a) 一个 \SI{100}{\gram} 的实心球限制在 \SI{5}{\metre} 的线道上，(b) 束缚在 \SI{1E-10}{\metre} 区域内的电子。}
能级公式
\begin{align}
    E_n = \frac{n^2\hbar^2}{8 m l^2}, \quad E_1 = \frac{h^2}{8ml^2},
\end{align}
代入数据得
\begin{align}
    &E_1 = \frac{(\SI{6.63E-34}{\joule\second})^2}{8\times\SI{1E-1}{\kilo\gram}\times(\SI{5}{\metre})^2} = \SI{2.20E-68}{\joule}, \\
    &E_1 = \frac{(\SI{6.63E-34}{\joule\second})^2}{8\times\SI{9.11E-34}{\kilo\gram}\times(\SI{1E-10}{\metre})^2} = \SI{6.03E-18}{\joule}. 
\end{align}

\subsection{3.3}
\homework{
    讨论如下定义的势箱中的粒子，
    \begin{equation}
        V(x) = 
\begin{cases}
    0, \quad &x\in \left[-\frac l2, \frac l2\right],\\
    +\infty, \quad &\text{其它},
\end{cases}
    \end{equation}
    求出能级与波函数。
}
在势箱以外的区域，波函数为 0。

在势箱中 $x \in \left[-\frac l2, \frac l2\right]$，势能 $V(x) = 0$，薛定谔方程为
\begin{align}
    -\frac{\hbar^2}{2m} \pdv[2]{\psi}{x} = E\psi,
\end{align}
令 $a^2 = \frac{2mE}{\hbar^2}$，通解为
\begin{align}
    \psi(x) = C_1 \cos ax + C_2 \sin ax,
\end{align}
由边界条件波函数连续
\begin{align}
    \psi\left(-\frac l2\right) = \psi\left(\frac l2\right) = 0,
\end{align}
得到
\begin{align}
    \begin{cases}
        C_1 = 0, \\
        \sin \frac{al}2 = 0,
    \end{cases}, \quad 
    \begin{cases}
        C_2 = 0, \\
        \cos \frac{al}2 = 0,
    \end{cases}
\end{align}
解得量子化条件为
\begin{align}
    \frac{al}2 = \frac{n\pi}2, \quad E = \frac{n^2h^2}{8 m l^2}.
\end{align}
归一化系数为
\begin{align}
    C_1 = C_2 = \sqrt{\frac2l},
\end{align}
波函数为
\begin{align}
    \psi(x) = \begin{cases}
        \sqrt{\frac2l} \cos\frac{n\pi x}l, \quad\text{$n$为奇数},\\
        \sqrt{\frac2l} \sin\frac{n\pi x}l, \quad\text{$n$为偶数}. \\
    \end{cases}
\end{align}

\subsection{3.4 (a)}
\homework{
    求
    $|C_1|^2$ 与 $|C_3|^2$ 
     的关系，并比较二者大小。
\begin{align}
    &C_3 = \frac12 \left[
        \left(1 + \frac{k_2}{k_3}\right) \ee^{\ii k_2 l} - 
        \left(1 - \frac{k_2}{k_3}\right) \ee^{-\ii k_2 l}
    \right] \ee^{-\ii k_3 l }C_1, \label{eq:half_inf_scat_c3}\\
    &C_4 = \frac12 \left[
        \left(1 - \frac{k_2}{k_3}\right) \ee^{\ii k_2 l} - 
        \left(1 + \frac{k_2}{k_3}\right) \ee^{-\ii k_2 l}
    \right] \ee^{\ii k_3 l} C_1, \label{eq:half_inf_scat_c4}
\end{align}
}
\begin{align}
    |C_3|^2 &= C_3C_3^* = |C_1|^2 \frac12 \left[
        \left(1 + \frac{k_2^2}{k_3^2}\right) - 
        \left(1 - \frac{k_2^2}{k_3^2}\right) \cos 2k_2l
    \right] \\
    &\leqslant |C_1|^2 \frac12 \left(
        1 + \frac{k_2^2}{k_3^2} - 1 + \frac{k_2^2}{k_3^2}
    \right) = |C_1|^2 \frac{k_2^2}{k_3^2} = |C_1|^2 \frac{E}{E - V_0}
\end{align}
因为 $V0 < E$，因此
\begin{align}
    |C_1|^2 < |C_3|^2.
\end{align}

\subsection{3.4(b)}
\homework{推导并画出 $z=12$、$z_0=9$ 时的体系波函数。}
由 $z$ 的定义可知
\begin{align}
    12 = \frac{l}{\hbar} \sqrt{2mE}, \quad 9 = \frac {l}{\hbar} \sqrt{2mV_0},
\end{align}
解得
\begin{align}
    V_0 = 72 \frac{\hbar^2}{ml^2}, \quad E = 81 \frac{\hbar^2}{ml^2},
\end{align}
% ref: https://www.yumpu.com/en/document/read/34504139/the-particle-in-a-half-infinite-well
$E > V_0$ 为散射态，同时有
\begin{align}
    k_2 = \frac zl = \frac{12}l, \quad k_3 = \frac{\sqrt{z^2-z0^2}}l = \sqrt{3\sqrt7}l,
\end{align}
波函数为
\begin{align}
    \psi(x) = \begin{cases}
        0, \quad & x < 0, \\
        C_1 \sin k_2 x, \quad & 0 \leqslant x \leqslant l, \\
        C_3 \ee^{\ii k_3 x} + C_4 \ee^{-\ii k_3 x}, &\quad x > l,
    \end{cases}
\end{align}
因此，可画出图像。
\begin{lstlisting}
Clear["Global`*"]
l = 1;
z = 12; z0 = 9;
k2 = z/l; k3 = Sqrt[z^2 - z0^2]/l;
C1 = I;
C3 = 1/2 ((1 + k2/k3) Exp[
        I k2 l] - (1 - k2/k3) Exp[-I k2 l]) Exp[-I k3 l] C1;
C4 = 1/2 ((1 - k2/k3) Exp[I k2 l] - (1 + k2/k3) Exp[-I k2 l]) Exp[
    I k3 l] C1;
\[Psi][x_] := 
    Piecewise[{{0, x < 0}, {2 I  C1 Sin[k2 x], 
    0 <= x <= l}, {C3 Exp[I k3 x] + C4 Exp[-I k3 x], x > l}}]
Plot[\[Psi][x], {x, -0.5, 3}, PlotRange -> All]
\end{lstlisting}

\subsection{3.6}
\homework{
    求出有限高方势垒（$E<V_0$）的波函数。
}
势函数表达式为
\begin{align}
    V(x) = \begin{cases}
        0, \quad &x <0,\\
        V_0, \quad &0\leqslant x \leqslant l, \\
        0, \quad &x>l,
    \end{cases}
\end{align}
假设波不会从 $+\infty$ 向左传播，则波函数可以写成如下形式，
\begin{align}
    \psi(x) = \begin{cases}
        C_1 \ee^{\ii k_1 x} + C_2 \ee^{-\ii k_2 x}, \quad &x < 0, \\
        C_3 \ee^{k_2 x} + C_4 \ee^{-k_2 x}, \quad& 0\leqslant x \leqslant l,\\
        C_5 \ee^{\ii k_1 x}, \quad&x>l,
    \end{cases}
\end{align}
其中
\begin{align}
    k_1^2 = \frac{2mE}{\hbar^2}, \quad k_2^2 = \frac{2m(V_0 - E)}{\hbar^2}. 
\end{align}
按照波函数在 $x=0$ 连续和导数的条件，有
\begin{align}
    &C_1 + C_2 = C_3 + C_4, \\
    &\ii k_1 (C_1 - C_2) = k_2 (C_3 - C_4),
\end{align}
波函数在 $x=l$ 连续和导数连续，有
\begin{align}
    &C_3 \ee^{k_2} + C_4 \ee^{-k_2} = C_5 \ee^{\ii k_1},\\
    &C_3 k_2 \ee^{k_2} - C_4 k_2 \ee^{-k_2} = \ii k_1\, C_5 \ee^{\ii k_1},
\end{align}
加上波函数归一化的条件，共有 5 个方程、5 个未知数，则该波函数必然可解。

用 $C_5$ 表示其它参数，可解得
\begin{align}
    &C_3 = C_5 \frac1{2k_2} \ee^{(\ii k_1 - k_2)l} (\ii k_1 + k_2), \\
    &C_4 = C_5 \frac1{2k_2} \ee^{(\ii k_1 + k_2)l} (-\ii k_1 + k_2), \\
    &C_1 = \frac12(C_3 + C_4) - \ii \frac{k_2}{2k_1} (C_3 - C_4) \\
    &\phantom{C_1} = C_5 \ee^{\ii k_1 l} 
    \left(
         - \ii \frac{k_1^2 - k_2^2}{2k_1k_2} \sinh k_2 l
         + \cosh k2 l
    \right),
    \\
    &C_2 = \frac12(C_3 + C_3) + \ii \frac{k_2}{2k_1} (C_3 - C_4) \\
    &\phantom{C_2} = C_5 \ee^{\ii k_1 l} \left(
        -\ii \frac{k_1^2 + k_2^2}{2k_1k_2} \sinh k_2 l
    \right).
\end{align}

当前模型可用来解释隧穿效应。当系数为 $C_1$ 的入射波到达势垒后，会产生 $C_2$ 的反射波、$C_3$ 的透射波，由此定义反射系数 $R$、透射系数 $T$，
\begin{align}
    &R = \frac{|C_2|^2}{|C_1|^2} = \frac{4 k_1^2 k_2^2}{4k_1^2 k_2^2 + (k_1^2 + k_2^2) \sinh^2 k_2 l}, \\
    &T = \frac{|C_3|^2}{|C_1|^2} = \frac{(k_1^2 + k_2^2) \sinh^2 k_2 l}{4k_1^2 k_2^2 + (k_1^2 + k_2^2) \sinh^2 k_2 l},
\end{align}
显然二者之和 $R+T=1$。

这个模型类似于隧道扫描显微镜，利用探测针尖 probe 和物体表面的隧穿电流测距，进而可扫描出样品表面形貌，精度可达 \SI{0.1}{\nano\metre}（氢原子直径 \SI{0.1}{\nano\metre}）。代入 $k_1$、$k_2$ 的定义，隧穿概率可表示为
\begin{align}
    T^{-1} = 1 + \frac1{4E \left(V_0 - \frac E{V_0}\right)} \sinh^2 \left(\frac l\hbar \sqrt{2m (V_0 - E)}\right),
\end{align}
利用 $V_0 \gg E$ 的条件，可推导得到
\begin{align}
    T \sim \exp(- k l),
\end{align}
其中隧穿系数、势垒宽度，可对应实验中的电流、探针样品距离。


\section{第四次课}
\subsection{4.2}
\homework{
    对谐振子标准方程
\begin{align}
    \pdv[2]{\psi(y)}{y} - (\lambda - y^2)\phi(y) = 0
\end{align}
做幂级数展开，给出系数的递推公式，并讨论能否从中得到量子化条件。
}
设 $\phi(y) = \sum_{n=0}^\infty c_n y^n$，其导数为
\begin{align}
    &\pdv{\psi(y)}{y} = \sum_{n=0}^{\infty} n c_n y^{n-1}, \\
    &\pdv[2]{\psi(y)}{y} = \sum_{n=2}^\infty n(n-1)c_n y^{n-2} = \sum_{n=0}^\infty (n+2)(n+1) c_{n+2} y^n,
\end{align}
代回标准方程，有
\begin{align}
    \sum_{n=0}^\infty (n+2)(n+1) c_{n+2} y^n + (\lambda - y^2)\sum_{n=0}^\infty c_n y^n &= 0 \\
    \sum_{n=0}^\infty (n+2)(n+1) c_{n+2} y^n 
    + \sum_{n=0}^\infty \lambda c_n y^n 
    - \sum_{n=0}^\infty c_n y^{n+2} &= 0
\end{align}
最后一项有 $y^{n+2}$，需要把前两项凑出 $y^{n+2}$。方法是，提出前两项 $n=0,1$ 的项，再把求和指标变换到 $n=0$ 开始。那么第一项为
\begin{align}
    &\phantom{=}2c_2 + 3\times2 c_3 y + \sum_{n=2}^{\infty} (n+2)(n+1) c_{n+2}y^n \\
    &= 2c_2 + 6 c_3 y + \sum_{n=0}^{\infty} (n+4)(n+3) c_{n+4} y^{n+2},
\end{align}
第二项同理可得
\begin{align}
    \lambda c_0 + \lambda c_1 + \sum_{n=2}^\infty \lambda c_{n} y^{n} = \lambda c_0 + \lambda c_1 + \sum_{n=0}^\infty \lambda c_{n+2} y^{n+1},
\end{align}
则
\begin{multline}
    2 c_2 + \lambda c_0 + 6 c_3 y + \lambda c_1 y 
    + \sum_{n=0}^{\infty} (n+4)(n+3) c_{n+4} y^{n+2} \\
    + \sum_{n=0}^\infty c_{n+2} y^{n+1}
    - \sum_{n=0}^\infty c_n y^{n+2} = 0,
\end{multline}
由多项式相等，可知各幂次的系数均为 0，得到
\begin{align}
    \begin{cases}
        2c_2 + \lambda c_0 = 0,\\
        6c_3 + \lambda c_1 = 0,\\
        (n+4)(n+3) c_{n+4} + \lambda c_{n+2} - c_n = 0
    \end{cases}
\end{align}
得到递推公式
\begin{align}
    &c_{n+4} = \frac{c_n - \lambda c_{n+2}}{(n+4) (n+3)}\\
    \Rightarrow {}&c_{n+2} = \frac{c_{n-2} - \lambda c_{n}}{(n+2) (n+1)},
\end{align}
由品优波函数有限的条件，假设在 $c_{n+2}$ 项终止，即
\begin{align}
    c_{n+2} = 0 \Rightarrow c_{n-2} - \lambda c_n = 0, \\
    c_{n+4} = 0 \Rightarrow c_n - \lambda c_{n+2} = 0,
\end{align}
易知 $c_n =0$，依次类推，每一项均为 0，因此难以得到量子化条件。

也可直接写出递推条件
\begin{align}
    (n+2) (n+1) c_{n+2} + \lambda c_n - c_{n-2} = 0,
\end{align}
说明其无法剥离出两项之间的关系.

\subsection{4.3}
\homework{
    针对谐振子 Hermite 方程
\begin{align}
    f''(y) - 2y f'(y) + (\lambda - 1) f(y) = 0,
\end{align}
引入变量 $\rho = y^2$，将 Hermite 方程演化为 Kummer's differential equation，并对其
做幂级数展开，给出系数递推公式和量子化条件。
}
参考顾樵《量子力学 卷I》P221

由 $\rho = y^2$ 得到 $y = \pm\sqrt\rho$，
\begin{align}
    &\frac{\dd f}{\dd\rho} = \frac{1}{2\sqrt\rho} \frac{\dd f}{\dd y}, \\
    &\frac{\dd^2f}{\dd\rho^2} = \frac1{4\rho} \frac{\dd^2y}{\dd y^2} - \frac{1}{4\rho^{3/2}} \frac{\dd f}{\dd y},
\end{align}
也可由 $\rho = y^2$ 得到 $2y\dd y = \dd\rho$，有
\begin{align}
    &\frac{\dd f}{\dd\rho} = \frac1{2y} \frac{\dd y}{\dd\rho}, \\
    &\frac{\dd^2 f}{\dd\rho^2} = \frac{1}{4\rho^2} \left(\frac{\dd^2 f}{\dd y^2} - \frac1y \frac{\dd f}{\dd y}\right),
\end{align}
后者避开了根号的正负号，二者结果一样，均可得到 Kummer 微分方程
\begin{align}
    \rho \frac{\dd^2y}{\dd\rho^2} + (c - \rho)\frac{\dd y}{\dd \rho} - a y = 0,
\end{align}
其中
\begin{align}
    a = - \frac{\lambda - 1}4, \quad c = \frac12,
\end{align}
设幂级数 $f = \sum_{n=0}^\infty b_n \rho^n$，
其导数为
\begin{align}
    &f' = \sum_{n=0}^\infty n b_n \rho^{n-1} = \sum_{n=1} n b_n \rho^{n-1} = \sum_{n=0}^\infty (n+1) b_{n+1} \rho^n, \\
    &f'' = \sum_{n=0}^\infty n(n-1) b_n \rho^{n-2} = \sum_{n=1}^\infty n(n-1) b_n \rho^{n-2} \notag \\
    &\phantom{f''} = \sum_{n=0}^\infty (n+1)n b_{n+1} \rho^{n-1}
\end{align}
代回 Kummer's 方程，有
\begin{align}
    \sum_{n=0}^{\infty}(n+1) n b_{n+1} \rho^n+\sum_{n=0}^{\infty} c(n+1) b_{n+1} l^n-\sum_{n=1}^{\infty} n b_n \rho^n-a \sum_{n=0}^{\infty} b_n \rho^n&=0 \notag \\
    \sum_{n=0}^{\infty}\left[(n+1) n b_{n+1}+c(n+1) b_{n+1}-(a+n) b_n\right] \rho^n&=0
\end{align}
系数满足
\begin{align}
    (n+1)(n+c) b_{n+1}-(a+n) b_n=0
\end{align}
前几项为
\begin{align}
    &b_1=\frac{a}{c} b_0 \\
&b_2=\frac{a+1}{2 (a+1)}  b_1=\frac{a (a+1)}{c \cdot(c+1)} \frac{b_0}{2 !} \\
&b_3=\frac{a+2}{3 (c+2)} b_2=\frac{a (a+1)(a+2)}{c \cdot(c+1)(c+2)} \frac{b_0}{3 !}
&b_4=\frac{a(a+1)(a+2)(a+3)}{c(c+1)(c+2)(c+3)} \frac{b_0}{4 !}
\end{align}
推出递推公式
\begin{align}
    b_n = \frac{a(a+1) \cdots (a+n-1)}{c(c+1)\cdots (c+n-1)} \frac{b_0}{n!},
\end{align}
则 $f$ 的表达式为
\begin{align}
    \sum_{n=0}^{\infty} b_n p^n=\left[1+\frac{a}{c} \frac{p}{1 !}+\frac{a \cdot(a+1)}{c(c+1)} \frac{p^2}{2 !}+\cdots \frac{a(a+1) \cdots(a+n-1)}{c(c+1) \cdots(c+n-1)} \frac{p^n}{n !}\right] b_0. 
\end{align}

合流超几何函数是 Kummer's 微分方程的一个通解，其表达式为
\begin{align}
    { }_1 F_1(a, c ; \rho)=1+\frac{a}{c} \frac{\rho}{1 !}+\frac{a \cdot(a+1)}{c(c+1)} \frac{\rho^2}{2 !}+\cdots \frac{a(a+1) \cdots(a+n-1)}{c(c+1) \cdots(c+n-1)} \frac{\rho^n}{n !}
\end{align}
通解为
\begin{align}
    f(\rho) = A\, {}_1F_1 \left(a,\frac12;\rho\right) + B \rho^{1/2} \, {}_1F_1 \left(a+\frac12, \frac32; \rho\right),
\end{align}
对无穷级数 ${}_1F_1\left(a,\frac12;\rho\right)$ 而言，截断条件为 $a = -n$，此时第 $n$ 项
\begin{align}
    \frac{a(a+1)\cdots(a+n-1)}{c(c+1)(c+n-1)} \frac{\rho^n}{n!} = \frac{(-1)^n n! \rho^n}{c(c+1)\cdots(c+n-1)n!} = \frac{(-1)^n \rho^n}{c(c+1)\cdots(c+n-1)},
\end{align}
当 $n$ 增加到某恰好的值时，第 $n$ 项 $\rightarrow 0$，可截断。

对于通解而言，截断条件为
\begin{align}
    \begin{cases}
        a = -n,\\B= 0,
    \end{cases}\ \text{or} \
    \begin{cases}
        a+\frac12=0,\\
        A=0,
    \end{cases}
\end{align}
第一种情况，$a = \frac{1-\lambda}4 = 0$，得到 $\lambda = 1+4n$，能量为
\begin{align}
    E = \frac{\hbar\omega}2 (1+4n) = \hbar\omega\left(2n+\frac12\right) \Rightarrow E_{2n},
\end{align}
第二种情况，$a+\frac12 = -n$，解得 $\lambda = 3+4n$，能量为
\begin{align}
    E = \hbar\omega\left(2n+1+\frac12\right) \Rightarrow E_{2n+1},
\end{align}
综上可知 $E = \hbar\omega \left(n + \frac12\right)$，与不引入 $\rho = y^2$ 的量子化条件和结果相同。
% 代入 Kummer 方程
% % \begin{align}
% %     \sum_{n=0}^\infty \left[
% %         2n(n+1)c_{n+1} + 2n c_{n+1} - 4n c_n + (\lambda -)
% %     \right]
% % \end{align}
% 得到递推公式
% \begin{align}
%     c_{n+1} = \frac{n+a}{n^2 + (c-1) n + c} c_n,
% \end{align}
% 解得量子化条件 $n + a = 0$，即 $\lambda = 4n + 1$。

\subsection{4.5}
\homework{
请证明
\begin{align}
    A_n = \left(\frac{m\omega}{\pi\hbar}\right)^{1/4} \frac1 {\sqrt{2^n n!}},
\end{align}
提示，可利用 Hermite 多项式生成函数
\begin{align}
    S(x,r) = \ee^{2xr -r^2} = \sum_{n=0}^{\infty} H_n(x) \frac{r^n}{n!}, 
\end{align}
来讨论，这里可参考顾樵《量子力学》P208---211。
}
按照生成函数，写出两项，
$$
\begin{aligned}
&\exp \left(2 \xi t-t^2\right)=\sum_{m=0}^{\infty} H_m(\xi) \frac{t^m}{m !} \\
&\exp \left(2 \xi r-r^2\right)=\sum_{n=0}^{\infty} H_n(\xi) \frac{r^n}{n !}
\end{aligned}
$$
上二式相乘，得到
$$
\exp \left(2 \xi t-t^2+2 \xi r-r^2\right)=\sum_{m=0}^{\infty} \sum_{n=0}^{\infty} H_m(\xi) H_n(\xi) \frac{t^m r^n}{m ! n !}
$$
为了凑出来波函数，用 $\mathrm{e}^{-\xi^2/2}\mathrm{e}^{-\xi^2/2}$ 乘上式两边，然后对 $\xi$ 从一 $-\infty$ 到 $\infty$ 积分, 得到
$$
\int_{-\infty}^{\infty} \exp \left[2 t r-(\xi+t+r)^2\right] \mathrm{d} \xi=\sum_{m=0}^{\infty} \sum_{n=0}^{\infty} \frac{t^m r^n}{m ! n !} \int_{-\infty}^{\infty} H_m(\xi) H_n(\xi) \mathrm{e}^{-\xi^2} \mathrm{~d} \xi
$$
现在上式左边的积分为
$$
\begin{aligned}
&\phantom{{}={}}\int_{-\infty}^{\infty} \exp \left[2 t r-(\xi+t+r)^2\right] \mathrm{d} \xi \\
&=\mathrm{e}^{2 r} \int_{-\infty}^{\infty} \exp \left[-(\xi+t+r)^2\right] \mathrm{d} \xi \quad(u=\xi+t+r) \\
&=\mathrm{e}^{2 r} \int_{-\infty}^{\infty} \mathrm{e}^{-u^2} \mathrm{~d} u=\mathrm{e}^{2 r} \sqrt{\pi}
\end{aligned}
$$
将 $\mathrm{e}^{2 r}$ 展开成幂级数：
$$
\mathrm{e}^{2 r r}=\sum_{n=0}^{\infty} \frac{(2 t r)^n}{n !}=\sum_{n=0}^{\infty} 2^n \frac{(t r)^n}{n !}
$$
由此，得到
$$
\sqrt{\pi} \sum_{n=0}^{\infty} 2^n \frac{(t r)^n}{n !}=\sum_{m=0}^{\infty} \sum_{n=0}^{\infty} \frac{t^m r^n}{m ! n !} \int_{-\infty}^{\infty} H_m(\xi) H_n(\xi) \mathrm{e}^{-\xi^2} \mathrm{~d} \xi
$$
该等式成立要求
$$
\int_{-\infty}^{\infty} H_m(\xi) H_n(\xi) \mathrm{e}^{-\xi^2} \mathrm{~d} \xi=2^n n ! \sqrt{\pi} \delta_{m n}
$$
归一化系数满足
$$
A_n = \sqrt{a}2^n n ! \sqrt{\pi}. 
$$

解法 2　厄米多项式的微分形式
\begin{align}
    H_{n} (x)= (-1)^{n} \ee^{x^2} \pdv[n]{x} \ee^{-x^2}
\end{align}
归一化系数
\begin{align}
        N_n&=\int_{-\infty}^{+\infty} H_n(x) H_n(x) \ee^{-x^2} \dd x\\
        &=(-1)^n \int_{-\infty}^{+\infty} H_n(x) \frac{\partial^n}{\partial x^n} \ee^{-x^2} \dd x\\
        &=(-1)^n\left[H_n(x) \frac{\partial^{n-1}}{\partial x^{n-1}} \ee^{-x^2}\right]_{-\infty}^{+\infty}-(-1)^n \int_{-\infty}^{+\infty} \frac{\partial H_n(x)}{\partial x} \frac{\partial^{n-1}}{\partial x_{n-1}} \ee^{-x^2} \dd x \notag \\
        &=(-1)^n\left[H_n(x) \frac{\partial^{n-1}}{\partial x^{n-1}} \ee^{-x^2}\right]_{-\infty}^{+\infty}+
        (-1)^{n+1} \int_{-\infty}^{+\infty} \frac{\partial H_n(x)}{\partial x} \frac{\partial^{n-1}}{\partial x_{n-1}} \ee^{-x^2} \dd x
\end{align}
其中
\begin{align}
    H_n(x) \frac{\partial^{n-1}}{\partial x^{n-1}} \ee^{-x^2} = H_n(x) H_{n-1} \ee^{-x^2}
\end{align}
$H_n(x) H_{n-1}$ 是有限值，$\ee^{-x^2}|_{-\infty}^{\infty} = 0$，所以归一化系数只剩后面一项，
\begin{align}
    N_n = (-1)^{n+1} \int_{-\infty}^{+\infty} \frac{\partial H_n(x)}{\partial x} \frac{\partial^{n-1}}{\partial x_{n-1}} \ee^{-x^2} \dd x. 
\end{align}
同理，再进行 $n-1$ 次分部积分，可得
\begin{align}
    N_n &= \intinf H_n(x) H_n(x) \ee^{-x^2} \dd x \\
    & = (-1)^{2n} \intinf \pdv[n]{H_n(x)}{x} \ee^{-x^2} \dd x.
\end{align}
$H_n(x)$ 的级数定义为
\begin{align}
    H_n(x) = \sum_{m=0}^{n/2} (-1)^m \frac{n!}{m!(n-2m)!} (2x)^{n-2m},
\end{align}
$x^n$ 中 $m=0$，系数为 $2^n$，
\begin{align}
    \pdv{H_n(x)}{x} = 2^n\times n x^{n-1} \times \cdots \times \pdv[n]{H_n(x)}{x} = 2^n n!
\end{align}
因此归一化系数 $N_n = 2^n n! \sqrt\pi$。

\subsection{顾樵书中 Morse 势能的部分推导}
在顾樵《量子力学》 \S 6.2.2，解 Morse 势的薛定谔方程，得到了微分方程
\begin{align}
    \xi^2 \pdv[2]{u}{\xi} + \xi \pdv{u}{\xi} + \left( - \lambda^2 + \frac{\eta}2\xi - \frac14\xi^2\right)u = 0,
\end{align}
并给出了在奇点 $\xi \rightarrow 0$ 的渐近形式
\begin{align}
    \xi\pdv{u}{\xi} - \lambda^2 u = 0,
\end{align}
问题在于，书上给出的解为 $u \propto \xi^\lambda$，它的确是所求微分方程的一个正确渐近形式，但显然这个渐近方程给出的解是 $\xi^{\lambda^2}$。

如果按照 $u(\xi) = \xi^{\lambda^2} \ee^{-\frac12\xi}y(\xi)$ 求解，会有什么情况？这里讨论一下。至于如何得到渐近方程，不讨论。

求一阶导数，
\begin{align}
    &\frac{\dd u(\xi)}{\dd \xi}=\lambda^2 \xi^{\lambda^2-1} e^{-\frac{1}{2} \xi} y(\xi)+\xi^2\left[\ee^{-\frac{1}{2} \xi} y(\xi)\right]^{\prime} \\
    &\xi \frac{\dd u(\xi)}{\dd \xi}=\lambda^2 \xi^{\lambda^2} \ee^{-\frac{1}{2} \xi} y(s)+\xi^{\lambda^2+1}\left[e^{-\frac{1}{2} \xi} y(\xi)\right]^{\prime}
\end{align}
当 $y\rightarrow0$，有
\begin{align}
    \frac{\xi^{\lambda^2}}{\xi^{n+1}}=\frac{1}{\xi}\Big|_{\xi \rightarrow 0} \rightarrow \infty,
\end{align}
因此一阶导为
\begin{align}
    \xi \frac{\dd u(\xi)}{\dd \xi}={}& \lambda^2 \xi^{\lambda^2} \ee^{-\frac{1}{2} \xi} y(\xi) \\
    ={}&\lambda^2 \xi^2 y(\xi)=\lambda^2 u. 
\end{align}
此时 $y(\xi) = 1$，推导出
\begin{align}
    \xi \dv[2]{y}{\xi} + (c-\xi) \dv{y}{\xi} - \frac12\left(
        c - \eta + \frac{\lambda^2 - \lambda^4}{\xi}    \right) y = 0, \quad c = 2\lambda^2 + 1. 
\end{align}

按照顾书中，设 $u(\xi) = \xi^{\lambda} \ee^{-\frac12\xi}y(\xi)$ ，一阶导数为
\begin{align}
    &\frac{\dd u}{\dd \xi}=\lambda \xi^{\lambda-1} \ee^{-\frac{1}{2} \xi} y(\xi)+\xi^\lambda\left[\ee^{-\frac{1}{2} \xi} y(\xi)\right]^{\prime} \\
    &\xi \frac{\dd y}{\dd \xi}=\lambda \xi^\lambda \ee^{-\frac{1}{2} \xi} y(\xi)+\xi^{\lambda+1}\left[\ee^{-\frac{1}{2} \xi} y(\xi)\right]^{\prime}\\
    &\phantom{\xi \frac{\dd y}{\dd \xi}}=\lambda \xi^\lambda e^{-\frac{1}{2} \xi} y(\xi) \\
    &\phantom{\xi \frac{\dd y}{\dd \xi}}=\lambda \underbrace{\xi^\lambda}_{u} y(\xi)=\lambda^2 u,
\end{align}
此时 $y(\xi) = \lambda$，推导出
\begin{align}
    \xi \dv[2]{y}{\xi} + (c-\xi) \dv{y}{\xi} - \frac12 (c-\eta) y = 0,
    \quad c = 2\lambda^2 + 1. 
\end{align}

\section{Week 5}
\subsection{5.1}
\homework{
比较谐振子和 Morse 势函数。

参考文献:
The Morse oscillator in position space, momentum space, and phase space. J. Chem. 
Phys. 1988, 88(7), 4535–4547, doi: 10.1063/1.453761

也可以尝试采用 Numerov 方法数值求解，Levine《Quantum Chemistry》4.4 p74}

\textbf{推荐阅读：}
量子力学本征值问题的数值方法——打靶法与Numerov方法 \url{https://zhuanlan.zhihu.com/p/59099100}

Numerov法解一维定态问题 \url{https://zhuanlan.zhihu.com/p/78619365}

\textbf{程序：}
Numerov: 
A python script that solves the one dimensional time-independent Schrodinger equation for bound states. The script uses a Numerov method to solve the differential equation and displays the desired energy levels and a figure with an approximate wave function for each of these energy levels.
\url{https://github.com/FelixDesrochers/Numerov}

\subsection{5.2}
\homework{
推导极坐标下的
$\hat{L}_z$
算符表示
\begin{align}
    \hat L_z = -\ii\hbar \pdv{\theta}
\end{align}
}
课上已推导极坐标下的偏导
\begin{align}
    &\pdv{x} = \cos\theta\pdv{r} - \frac{\sin\theta}r \pdv\theta , \\
    &\pdv{y} = \sin\theta\pdv{r} + \frac{\cos\theta}r \pdv\theta,
\end{align}
代入 $\hat L_z$ 的定义中得到
\begin{align}
    \hat L_z &= -\ii\hbar \left(x\pdv{y} - y\pdv{x}\right)\\
    &=-\ii\hbar \left[
        r\cos\theta \left(
            \sin\pdv{r} + \frac{\cos\theta}r \pdv\theta
        \right)
        - r\sin\theta \left(
            \cos\theta\pdv{r} - \frac{\sin\theta}r \pdv\theta
        \right)
    \right] \notag\\
    &= -\ii\hbar \pdv\theta. 
\end{align}
\subsection{5.3}
\homework{
对于一维环形势箱，其能级为
\begin{align}
    E_n = \frac{n^2h^2}{8\pi^2mR^2},\quad n=0,\pm1, \pm2, \cdots,
\end{align}
苯环的 $\mathrm{\pi}$
电子可以近似看成是电子限制在一个环上的运动，$\mathrm{\pi}$
电子环的半径为
\SI{1.4}{\angstrom}。请以一维环形势箱的模型，计算其最低激发能。

（以下选做）激发能的实验值是 \SI{2600}{\angstrom}，讨论误差可能的来源。
}
对于该体系，HOMO 对应 $n = 1$，LUMO 对应 $n = 2$。因此，
\begin{align}
\Delta E &= E_2 - E_1 = \frac{3 h^2}{8 \pi^2 m R^2} \\&= \frac{3 \times \num{6.626e-34} \si{J.s}}{8 \pi^2 \times \num{9.109e-31} \si{kg} \times (\num{1.4e-10} \si{m})^2} = \num{9.344e-19} \si{J}
\end{align}
同时，$\Delta E = h c / \lambda$
\begin{equation}
\frac1{\lambda} = \frac{h c}{\Delta E} = \frac{\num{6.626e-34} \si{J.s} \times \num{2.998e8} \si{m.s^{-1}}}{\num{9.344e-19} \si{J}} = \SI{2126}{\angstrom}
\end{equation}
事实上，我们可以从两方面考虑改进。一方面，苯环可以当作六边形而非圆形；另一方面，离域键不可能只限定于一维，而会一定程度上弥散到周围。从这两方面，可以对苯环的能级作改性。
\subsection{5.4}
\homework{求解长为 $l$，半径为 $R$ 的圆柱体体系的能级，这里的势函数定义为
\begin{align}
    V(x,y,z) = \begin{cases}
        0, \quad &(x,y,z) \in \Omega, \\
        +\infty,\quad &(x,y,z) \notin \Omega,
    \end{cases}
\end{align}
其中
\begin{align}
    \Omega = \left\{
    (x,y,z) | x^2+ y^2 \leqslant R^2,\ 0\leqslant z\leqslant l
\right\}. 
\end{align}
参考文献：Yao, J.; Xu, X; Wu, D.; et al. Chem. Commum. 2000, 1627–1628, DOI: 
10.1039/b002717k
}
首先，我们列出圆柱坐标的 Laplacian 算符：
\begin{equation}
\nabla^2 = \frac{\partial^2}{\partial r^2} + \frac{1}{r} \frac{\partial}{\partial r} + \frac{1}{r^2} \frac{\partial^2}{\partial \phi^2} + \frac{\partial^2}{\partial z^2}
\end{equation}
该问题可以作变量分离。我们可以令 $\psi = \mathcal{R}(r) \Phi(\phi) Z(z)$。那么 Schrodinger 方程可以写为
\begin{equation}
\frac{1}{\mathcal{R}} \left( \frac{\partial^2 \mathcal{R}}{\partial r^2} + \frac{1}{r} \frac{\partial \mathcal{R}}{\partial r} \right) + \frac{1}{r^2} \frac{1}{\Phi} \frac{\partial^2 \Phi}{\partial \phi^2} + \frac{1}{Z} \frac{\partial^2 Z}{\partial z^2} = - \frac{2 m E}{\hbar^2}
\end{equation}
一个平凡的变量分离是将 $z$ 分开，我们写出下述方程：
\begin{equation}
\frac{1}{Z} \frac{\partial^2 Z}{\partial z^2} = - \frac{2 m E_z}{\hbar^2}
\end{equation}
根据边界条件 $Z(0) = Z(l) = 0$，可以给出关于 $z$ 方向的量子数 (这等同于一维势箱问题)：
\begin{align}
E_{n_z} &= \frac{n_z^2 \hbar^2 \pi^2}{2 m l^2},\; n_z = 1, 2, 3, \cdots \\
Z_{n_z} (z) &= \sqrt{\frac{2}{l}} \sin \left( \frac{n_z \pi z}{l} \right)
\end{align}

随后我们处理关于 $r, \phi$ 的问题。首先，关于 $\phi$ 的边界条件 $\Phi(0) = \Phi(2 \pi)$，以及 $\Phi^{-1} \partial_\phi^2 \Phi$ 为常数的条件，就能给出下述结论：
\begin{equation}
\frac{1}{\Phi} \frac{\partial^2 \Phi}{\partial \phi^2} = - n_\phi^2
\end{equation}
\begin{align}
\Phi_{n_\phi} (\phi) &= \sqrt{\frac{1}{2\pi}} \ee^{i n_\phi \phi},\; n_\phi = 0, \pm 1, \pm 2, \cdots
\end{align}
%因此，

从而径向函数的方程化为
\begin{equation}
\frac{\partial^2 \mathcal{R}}{\partial r^2} + \frac{1}{r} \frac{\partial \mathcal{R}}{\partial r} - \frac{n_\phi^2}{r^2} \mathcal{R} = - k^2 \mathcal{R}
\end{equation}
其中，
\begin{equation}
k = \frac{\sqrt{2 m (E - E_{n_z})}}{\hbar}
\end{equation}
这恰好是 Bessel 方程问题，其有两个通解：
\begin{equation}
\mathcal{R}(r) = C_1 J_{n_\phi} (k r) + C_2 Y_{n_\phi} (k r)
\end{equation}
其中，$J_m (r)$ 与 $Y_m (r)$ 分别为第一类与第二类 $m$ 阶 Bessel 函数。由于 $Y_m (0)$ 对任意 $m$ 都为无穷大，不能作为品优波函数，因此
\begin{equation}
\mathcal{R}(r) = C_1 J_{n_\phi} \left( \frac{\sqrt{2 m (E - E_{n_z})}}{\hbar} r \right)
\end{equation}
随后引入 $\mathcal{R}(R) = 0$ 的边界条件：
\begin{equation}
J_{n_\phi} \left( \frac{\sqrt{2 m (E - E_{n_z})}}{\hbar} R \right) = 0
\end{equation}
设 $\beta_{n_r n_\phi}$ 是 $n_\phi$ 阶第一类 Bessel 的第 $n_r$ 个根：
\begin{equation}
J_{n_\phi} (\beta_{n_r n_\phi}) = 0
\end{equation}
那么
\begin{align}
E_{n_r n_\phi} &= \frac{\beta_{n_r n_\phi}^2 \hbar^2}{2 m R^2} \\
\mathcal{R}_{n_r n_\phi} (r) &= C_{n_r n_\phi} J_{n_\phi} \left( \frac{\sqrt{2 m E_\mathrm{n_r n_\phi}}}{\hbar} r \right)
\end{align}
其中，$C_{n_r n_\phi}$ 是归一化系数。

综上，
\begin{align}
\psi(r, \phi, z) &= C_{n_r n_\phi} \sqrt{\frac{1}{\pi l}} J_{n_\phi} \left( \frac{\sqrt{2 m E_{n_r n_\phi}}}{\hbar} r \right) \ee^{i n_\phi \phi} \sin \left( \frac{n_z \pi z}{l} \right) \\
E_{n_r n_\phi n_z} &= \frac{\beta_{n_r n_\phi}^2 \hbar^2}{2 m R^2} + \frac{n_z^2 \hbar^2 \pi^2}{2 m l^2}
\end{align}
参考：
顾樵《数学物理方法》 \S 13.3
\subsection{5.5}
\homework{
证明
\begin{align}
&\hat L_x = -\ii\hbar \left(
    \sin\varphi \pdv{\theta} + \cot\theta \, \cos\varphi \pdv{\varphi}
\right), \\
&\hat L_y = -\ii\hbar
\left(
    \cos\varphi \pdv{\theta} - \cot\theta \sin\varphi \pdv{\varphi}
\right),
\end{align}
并且利用
\begin{align}
\hat L = \hat L_x \vec i + \hat L_y \vec j + \hat L_z \vec k
\end{align}
推导
\begin{align}
\hat L^2 = \hat L_x^2 + \hat L_y^2 + \hat L_z^2 = -\hbar^2 \left(
    \frac{1}{\sin^2\theta}
    \pdv[2]{\varphi} + \cot\theta \pdv{\theta} + \pdv[2]{\theta}
\right). 
\end{align}
}
\begin{equation}\label{key}
x = r\sin\theta\cos\phi ,\; y = r\sin\theta\sin\phi, z = r\cos\theta
\end{equation}
\begin{align}
\pdv{r}{x} &= \dfrac{x}{r} = \sin\theta\cos\phi \\
\pdv{r}{y} &= \sin\theta\sin\phi \\
\pdv{r}{z} &= \cos\theta
\end{align}
\begin{align}
\pdv{\theta}{x} &= \dfrac{1}{r}\cos\theta\cos\phi \\
\pdv{\theta}{y} &= \dfrac{1}{r}\cos\theta\sin\phi \\
\pdv{\theta}{z} &= -\dfrac{1}{r}\sin\theta
\end{align}
\begin{align}
\pdv{\phi}{x} &= -\dfrac{\sin\phi}{r\sin\theta} \\
\pdv{\phi}{y} &= \dfrac{\cos\phi}{r\sin\theta} \\
\pdv{\phi}{z} &= 0
\end{align}
所以
\begin{align}
\pdv{x} &= \pdv{r}{x} \pdv{r} + \pdv{\theta}{x} \pdv{\theta} + \pdv{\phi}{x} \pdv{\phi} = \sin\theta\cos\phi \pdv{r} + \dfrac{1}{r}\cos\theta\cos\phi \pdv{\theta} -\dfrac{\sin\phi}{r\sin\theta} \pdv{\phi} \\
\pdv{y} &= \pdv{r}{y} \pdv{r} + \pdv{\theta}{y} \pdv{\theta} + \pdv{\phi}{y} \pdv{\phi} = \sin\theta\sin\phi \pdv{r} + \dfrac{1}{r}\cos\theta\sin\phi \pdv{\theta} +\dfrac{\cos\phi}{r\sin\theta} \pdv{\phi} \\
\pdv{z} &= \pdv{r}{z} \pdv{r} + \pdv{\theta}{z} \pdv{\theta} + \pdv{\phi}{z} \pdv{\phi} = \cos\theta \pdv{r} - \dfrac{1}{r}\sin\theta \pdv{\theta}
\end{align}
\begin{align}\label{key}
\hat L_x &= y \hat p_z - z \hat p_y = -i\hbar \qty(y \pdv{z} - z\pdv{y}) \notag\\
&= ... = i\hbar \qty(\sin\phi \pdv{\theta} + \cot\theta\cos\phi\pdv{\phi}) \\
\hat L_y &= z \hat p_x - x \hat p_z = -i\hbar \qty(z \pdv{x} - x\pdv{z}) \notag\\
&= ... = -i\hbar \qty(\cos\phi \pdv{\theta} - \cot\theta\sin\phi\pdv{\phi}) 
\end{align}

\begin{align}
\hat L^2 &= \hat L_x^2 + \hat L_y^2 + \hat L_z^2 \notag\\
&= -\hbar^2 \left[\pdv[2]{\theta} + \cot^2\theta \cos\phi \qty(-\sin\phi\pdv{\phi} + \cos\phi\pdv[2]{\phi})  \right. \notag\\
&{}\quad + \cot^2\theta \sin\phi \qty(\cos\phi\pdv{\phi} + \sin\phi\pdv[2]{\phi}) \notag\\
& {}\quad \left. + (\text{cross terms}) + \pdv[2]{\phi} \right] \notag\\
&= -\hbar^2 \qty[\pdv[2]{\theta} + \cot^2\theta \pdv[2]{\phi} + \cot\theta\pdv\theta + \pdv[2]{\phi} ] \notag\\
&= -\hbar^2 \qty[\dfrac{1}{\sin\theta}\pdv{\theta}\qty(\sin\theta\pdv{\theta})  + \csc^2\theta \pdv[2]{\phi}  ]
\end{align}

\section{Week 6}
\subsection{6.1}
\homework{
对于一个电子 $m_{\mathrm{e}}=\SI{9.11E-31}{\kilo\gram}$，以及一个陀螺 $m=\SI{0.02}{\kilo\gram}$，如果转动半径均为
$r=\SI{1.0}{\centi\metre}$，且运动速度均为 $\SI{1}{\metre\per\second}$，求被允许的角动量最小的$\theta$值。
}
经典的角动量公式为 $|l| = |r \times p| = |m r v|$。对于电子，其角动量为
\begin{equation*}
|l| = \num{9.11e-31} \si{kg} \cdot \num{0.01} \si{m} \cdot \num{1} \si{m.s^{-1}} = \num{9.11e-33} \si{J.s} \simeq \sqrt{86 \times (86+1)} \hbar
\end{equation*}
因此，电子的最小夹角为
\begin{equation*}
\theta_\mathrm{min} = \arccos \frac{86}{\sqrt{86 \times 87}} = 6.15^\circ
\end{equation*}
对于普通的陀螺，其角动量为
\begin{equation*}
|l| = \num{0.02} \si{kg} \cdot \num{0.01} \si{m} \cdot \num{1} \si{m.s^{-1}}= \num{0.0002} \si{J.s}
\end{equation*}
由此推断其 $l = \num{1.897e30}$；那么最小夹角为
\begin{equation*}
\theta_\mathrm{min} = \arccos \frac{l}{\sqrt{l (l + 1)}} \simeq \sqrt{1/l} = \num{4.16e-14} {}^\circ
\end{equation*}
其中的近似由 $\arccos \rightarrow \arcsin$ 变换后得到。

对于 cos 求夹角，在求解时不太方便，所以利用勾股定理求出 $\hat L$、$\hat L_z$ 组成的零一条边的长度为 $\hbar \sqrt{l}$，那么夹角也可表示为
\begin{align}
    \theta = \arctan \frac1{\sqrt{l}} \sim \frac1{\sqrt l}, 
\end{align}
这样更容易近似和求数值解。

\section{Week 7}
\subsection{7.1}
\homework{
对于包含 3 个粒子的体系，约化质量后的 $\hat H$
能否分离变量？对于包含 $N$ 个
粒子的体系情况呢？为什么要引入 Born--Oppenheimer 近似？
}
% \\vec\{(.)(.{2,3})\}
% \\vec{$1}$2
对于第一个问题很难清楚地回答，因为可以分离变量能写出清楚的表达式，但不能分离变量则难以证明。一个结论是量子力学中，仅包含\textsf{库伦相互作用}的三粒子体系是不可分离变量的。
%关于天体的三体问题，可以参考 \href{http://www.phys.lsu.edu/faculty/gonzalez/Teaching/Phys7221/ThreeBodyProblem.pdf}{参考资料 1}、\href{https://dx.doi.org/10.1007/s12045-019-0760-1}{参考资料 2}。

如果单纯地是将体系的约化质心分离出去，那么我们定义
\begin{align*}
M_3 &= m_1 + m_2 + m_3 \\
\mu_{13}^{-1} &= m_1^{-1} + m_3^{-1} \\
\mu_{23}^{-1} &= m_2^{-1} + m_3^{-1} \\
\vec{r}_\mathrm{CM} &= \frac{m_1 \vec{r}_1 + m_2 \vec{r}_2 + m_3 \vec{r}_3}{m_1 + m_2 + m_3}
\end{align*}
我们为了势能表示的方便，换取的坐标系形式是
\begin{align*}
\vec{J}_1 &= \vec{r}_1 - \vec{r}_3 \\
\vec{J}_2 &= \vec{r}_2 - \vec{r}_3 \\
\vec{J}_3 &= \vec{r}_\mathrm{CM}
\end{align*}
可以验证，动能算符可以表示为
\begin{equation*}
\hat T
= - \frac{\hbar^2}{2} \left( \frac{1}{m_1} \nabla_{\vec{r}_1}^2 + \frac{1}{m_2} \nabla_{\vec{r}_2}^2 + \frac{1}{m_3} \nabla_{\vec{r}_3}^2 \right)
= - \frac{\hbar^2}{2} \left( \frac{1}{\mu_{13}} \nabla_{\vec{J}_1}^2 + \frac{1}{\mu_{23}} \nabla_{\vec{J}_2}^2 + \frac{1}{M} \nabla_{\vec{J}_3}^2 + {\color{red} \frac{2}{m_3} \nabla_{\vec{J}_1} \cdot \nabla_{\vec{J}_2}} \right)
\end{equation*}
势能算符可以表示为
\begin{equation*}
\hat V
= \frac{e^2}{4 \pi \varepsilon_0} \left( \frac{Z_1 Z_2}{|\vec{r}_1 - \vec{r}_2|} + \frac{Z_1 Z_3}{|\vec{r}_1 - \vec{r}_3|} + \frac{Z_2 Z_3}{|\vec{r}_2 - \vec{r}_3|} \right)
= \frac{e^2}{4 \pi \varepsilon_0} \left( \frac{Z_1 Z_2}{|\vec{J}_1 - \vec{J}_2|} + \frac{Z_1 Z_3}{|\vec{J}_1|} + \frac{Z_2 Z_3}{|\vec{J}_2|} \right)
\end{equation*}
这种做法下，$\vec{J}_1, \vec{J}_2$ 近乎于是不能变量分离的。

注意这里不能分离变量并不是单纯由于动能算符引起的。如果粒子间无相互作用，动能算符显然是可以分离变量的；这里是由于有相互作用，才需要进行坐标变换，导致动能算符看起来也不能分离变量。

% 但第一个问题可能会产生下述误解：三体问题的 Schrodinger 方程是否可解？这样一个问题要作重新界定。我们求解的是非定态方程还是定态方程？我们是求解能量还是波函数？
% \begin{itemize}[nosep]
% \item 如果对象是非定态方程的波函数，即波包随着时间的演化而变化的过程，那么这\textsf{猜测}是混沌的；一般称混沌是不可解的。
% \item 如果对象是定态方程的波函数，那么以 \ce{He} 原子为例，是可以清楚地通过 Full-CI (Full Configuration Interaction) 与 Infinite-Basis 方法作级数展开求解；只是这种级数展开不是单粒子函数，而是两粒子函数的。
% \item 上面又涉及到“可解”是如何定义的。这并不是一个清楚界定的概念 (\href{https://en.wikipedia.org/wiki/Closed-form_expression}{Wikipedia: Closed-form expression})，但大致上可以认为可以级数求和的函数是解析的，因此称为可解的。解析的函数未必一定要是具有现成定义的函数，譬如超几何函数；它只要在计算机中可以在任意精度下数值地实现即可。
% \item 如果对象是定态方程的能量，那么也称为是可解的，因为通过上述波函数 $| \psi \rangle$ 的级数求和，定态体系的能量可以通过 $\langle \psi | \hat H | \psi \rangle$ 同样地级数求和。因此，\ce{He} 原子的能量尽管不具有简单的形式，但确实是可以求得的。
% \end{itemize}

第二个问题的分析等同于第一个问题，因此不再赘述。

第三个问题：目的单纯地是将电子与原子核的运动进行分离，这使得问题的讨论简洁与有效，在电子能级中排除了原子核运动 (振动、与电子运动的耦合) 的贡献。在实际的量化计算中，Gaussian 型基组一般设为原子轨道，它与原子核坐标有关；如果不使用 BO 近似，这个方法就从根本上不能成立。而一些要同时考虑电子与原子运动的情况 (分子动力学、光谱等) 一般也不需要考虑电子与原子耦合的情况，至多只需要将电子波函数与原子波函数的乘积构成总波函数即可。

它对于绝大多数体系的精确求解上并没有贡献：氢原子在 BO 近似下仍然可以简单地求解，\ce{He} 原子或各种分子在 BO 近似下仍然不能简单地求解。为数不多在 BO 近似下可简单且精确求解的体系可以是 \ce{H^+_2}，它将三体问题化为 Euler 问题 (\href{https://en.wikipedia.org/wiki/Euler\%27s_three-body_problem}{Wikipedia: Euler's three-body problem}，并可参考 Levine 13.4 节) 从而可分离变量地求解。
%因此，可能更为关键的问题是 BO 近似的合理性，但这是后话了。

\subsection{7.2}
\homework{
氢原子轨道径向函数的表达式为
\begin{align}
R_{nl}(r) = N r^l \ee^{-\frac{Zr}{na_0}} \sum_{k=0}^{n-l-1} b_k r^k
\end{align}
求归一化因子 $N$。
}
这里我们认为级数求和式为广义 Laguerre 多项式，微分定义方式参考徐光宪式 (3.4.9, 3.4.14)：
\begin{align}
L_n (\rho) &= e^n \frac{\partial^n}{\partial \rho^n} (e^{-\rho} \rho^n) \\
L_n^m (\rho) &= \frac{\partial^m}{\partial \rho^m} L_n (\rho)
\end{align}
原题的证明化为
\begin{equation}
R_{nl} (\rho) = N \rho^l e^{- \rho / 2} L_{n + l}^{2 l + 1} (\rho)
\end{equation}
但从积分的角度上，使用生成函数 (徐光宪，式 3.4.18) 会方便很多：
\begin{equation}
U_m (\rho, u) = \sum_{p = s}^\infty \frac{L_p^s (\rho)}{p!} u^p = (-1)^s (1 - u)^{- (s + 1)} \exp \left( - \frac{\rho u}{1 - u} \right) u^s
\end{equation}

下面的讨论都参考徐光宪 \S 3.4.8。我们首先确定归一化积分形式：
\begin{align}
1 = \int_0^{+\infty} r^2 R_{nl}^2 (\rho) \, \mathrm{d} r
&= \left( \frac{n a_0}{2 Z} \right)^3 \int_0^{+\infty} \rho^2 R_{nl}^2 (\rho) \, \mathrm{d} \rho \\
&= \left( \frac{n a_0}{2 Z} \right)^3 N_{nl}^2 \int_0^{+\infty} e^{-\rho} \rho^{2 l + 2} [L_{n + l}^{2 l + 1} (\rho)]^2 \, \mathrm{d} \rho
\end{align}
注意到上式中利用到 $\rho = \frac{2 Z r}{n a_0}$ 的换元。基于这个情况，我们下面先证明：
\begin{equation}
\int_0^{+\infty} e^{-\rho} \rho^{s+1} [L_p^s(\rho)]^2 \, \mathrm{d} \rho = \frac{(p!)^3 (2 p - s + 1)}{(p - s)!}
\end{equation}
我们让两个生成函数相乘，并作积分：
\begin{align}
&\quad \int_0^{+\infty} e^{-\rho} \rho^{s+1} U_s(\rho, u) U_s(\rho, v) \, \mathrm{d} \rho \\
&= \sum_{p = 0}^\infty \sum_{q = 0}^\infty \frac{u^p v^q}{p! q!} \int_0^{+\infty} e^{- \rho} \rho^{s+1} L_p^s (\rho) L_q^s (\rho) \, \mathrm{d} \rho \\
&= (-1)^{2s} \frac{u^s v^s}{(1-u)^{s+1} (1-v)^{s+1}} \int_0^{+\infty} \rho^{s+1} \exp \left[ - \rho \left( 1 + \frac{u}{1-u} + \frac{v}{1-v} \right) \right] \, \mathrm{d} \rho \\
&= \frac{u^s v^s}{(1-u)^{s+1} (1-v)^{s+1}} \left( 1 + \frac{u}{1-u} + \frac{v}{1-v} \right)^{-(s+2)} (s+1)! \\
&= (s+1)! (1-u) (1-v) \frac{(uv)^s}{(1-uv)^{s+2}} \\
&= (s+1)! (1-u-v+uv) \sum_{k=0}^\infty \frac{(s+k+1)!}{k!(s+1)!} (uv)^{s+k}
\end{align}
\suppInfo{Note}{
上式使用到许多技巧。其中，第 1 个等号是用生成函数在广义 Laguerre 多项式下展开的定义，第 2 个等号是用生成函数本身的定义给出，第 4 个等号是化简表达式。第 3 个等号是一个关于 Gamma 函数的积分：
\begin{equation*}
\int_0^{+\infty} \rho^{s+1} \exp(-a \rho) \, \mathrm{d} \rho = \frac{\Gamma(s+2)}{q^{s+2}} = \frac{(s+1)!}{q^{s+2}}
\end{equation*}
第 5 个等号是在 $uv = 0$ 邻域的泰勒展开；如果我们定义 $f(x) = (1-x)^{-s-2}$，那么：
\begin{align*}
f(x) &= \sum_{k=0}^\infty \frac{1}{k!} f^{(k)}(0) x^k = \sum_{k=0}^\infty \frac{1}{k!} x^k \frac{\partial^k}{\partial x^k} (1 - x)^{- s - 2} \\
&= \sum_{k=0}^\infty \frac{1}{k!} x^k \frac{(s+2+k-1)!}{(s+2-1)!} = \sum_{k=0}^\infty \frac{(s+k+1)!}{k!(s+1)!} x^k
\end{align*}
将上式的 $x$ 替换为 $uv$ 即得到结果。
}
我们注意到上面连等式的 $u, v$ 可以是任意复数。现在我们是希望求当角标 $p = q$ 时，广义 Laguerre 多项式的积分。我们取上面连等式中 $(uv)^p$ 幂次的系数出来：
\begin{align}
\frac{1}{(p!)^2} \int_0^{+\infty} e^{- \rho} \rho^{s+1} [L_p^s (\rho)]^2 \, \mathrm{d} \rho
&= (s+1)! \left[ \left. \frac{(s+k+1)!}{k!(s+1)!} \right|_{s+k=p} + \left. \frac{(s+k+1)!}{k!(s+1)!} \right|_{s+k=p-1} \right] \\
&= \frac{(p+1)!}{(p-s)!} + \frac{p!}{(p-s-1)!} = \frac{(2t-s+1) p!}{(p-s)!} \\
\int_0^{+\infty} e^{- \rho} \rho^{s+1} [L_p^s (\rho)]^2 \, \mathrm{d} \rho
&= \frac{(2t-s+1) (p!)^3}{(p-s)!}
\end{align}

现在我们可以代入 $p=n+l, s=2l+1$ 的条件进来，立即得到
\begin{align*}
1 = \int_0^{+\infty} r^2 R_{nl}^2 (\rho) \, \mathrm{d} r
&= \left( \frac{n a_0}{2 Z} \right)^3 N_{nl}^2 \int_0^{+\infty} e^{-\rho} \rho^{2 l + 2} [L_{n + l}^{2 l + 1} (\rho)]^2 \, \mathrm{d} \rho \\
&= N_{nl}^2 \left( \frac{n a_0}{2 Z} \right)^3 \frac{2n [(n+l)!]^3}{(n-l-1)!} \\
N_{nl} &= \sqrt{\left( \frac{2 Z}{n a_0} \right)^3 \frac{(n-l-1)!}{2n [(n+l)!]^3}}
\end{align*}
至于归一化系数前的负号，可能是由于其它原因导致的，但这不是我们需要关心的。


\subsection{7.3}
\homework{写一个生成连带 Laguerre 多项式的代码，以 $n$ 和 $l$ 为输入。}

\textbf{明确目标}：事实上我们需要生成的是连带Laguerre多项式有几项和各项的系数(最好用有理数表示)。

以 $n$ 和 $l$ 为输入，或$ \nu,\alpha $为输入都是可以的(见下面定义)。

例如，假如我们知道$n=3,l=0$时，$L_{n-l-1}^{2l+1}(x) = L_2^1(x) = \dfrac{1}{2}(6-6x+x^2) $，程序应当能满足
\begin{itemize}[nosep]
\item 输入 \texttt{[3,0]} 或 \texttt{[2,1]}
\item 输出 \texttt{[3, -3, 1/2]} 或  \texttt{"3 - 3x + (1/2)x\textasciicircum2"}
\end{itemize}
\textbf{方法}：
比较直接的方法是通过级数定义\eqref{poly}\eqref{poly2}。也可通过微分表示\eqref{diff}\eqref{diff2}或Rodrigues公式\eqref{rodr}或递推关系。

难点在于如何实现有理数的运算，甚至求导运算(如采用微分公式)。
这在数值计算语言中是比较麻烦的(C, Python)，但在符号计算语言中十分自然(Wolfram, sympy)。
当然，直接调用符号计算语言中的广义Laguerre函数是不允许的。

\subsection{7.4}
\homework{
a. 实轨道 $\mathrm{p}_x$、$\mathrm{p}_y$、$\mathrm{p}_z$ 和复轨道 $\mathrm{p}_{-1}$、$\mathrm{p}_0$、$\mathrm{p}_{+1}$ 之间的变换关系是怎样的？

b. 分别画出 $\mathrm{p}_x$、$\mathrm{p}_y$、$\mathrm{p}_z$ 和 $\mathrm{p}_{-1}$、$\mathrm{p}_0$、$\mathrm{p}_{+1}$ 轨道的图像并进行比较。
}

\subsection{7.5}
\homework{
画出 1s、2s、3s、3p、3d 的轨道径向函数 $R(r)$---$r$ 和径向分布函数 $D(r)$---$r$ 的图
像。
}

\section{Week8}
第8次课，第10个教学周
\subsection{8.1}
\homework{采用下列 Gaussian 函数作为氢原子的基态波函数
\begin{align}
    \psi = \exp\!\left(-\frac{\lambda r^2}{a_0^2}\right)
\end{align}
其中，$\lambda$
是变分参数，$a_0$
是 Bohr 半径。通过变分法给出能量表达式，并求出与
真实氢原子基态能量的差别。
}
\subsection{8.2}
\homework{
从变分原理出发，推导定态薛定谔方程。}
变分原理告诉我们，给定一个体系的 Hamiltonian $\hat H$，%其有正交归一完备本征波函数集合 $\{ \Psi_i \}$ 以及对应的本征能量 $\{ E_i \}$，且
最低能级为 $E_0$。如果 $\Phi$ 是任意一个满足此问题边界条件的品优波函数，那么
\begin{equation}
	\dfrac{\Braket{ \Phi | \hat H | \Phi }}{\Braket{ \Phi | \Phi }} \geq E_0
\end{equation}
把 $ \Phi $用$\hat H$的正交归一本征波函数展开
\begin{align}\label{key}
	\dfrac{\Braket{ \Phi | \hat H | \Phi }}{\Braket{ \Phi | \Phi }} &= \dfrac{\sum_i\sum_j c_i^* c_j \Braket{\psi_i | \hat H | \psi_j}}{\sum_i\sum_j c_i^* c_j \Braket{\psi_i |  \psi_j}} 
	= \dfrac{\sum_i\sum_j c_i^* c_j E_j \delta_{ij}}{\sum_i \sum_j c_i^* c_j \delta_{ij}} \notag\\
	&= \dfrac{ \sum_i |c_i|^2 E_i }{\sum_i  |c_i|^2} 
\end{align}
那么取等号的条件是$ c_0 = 1, c_{i\neq 0} = 0$。所以$ \Phi = \psi_0 $，满足
\begin{equation}\label{key}
	\hat H \Phi = E_0 \Phi
\end{equation}
%\tcbline
也可使用 曾谨言 \S 14.1.1 的表述。


\subsection{8.3}
\homework{请用下述波函数作为尝试波函数
\begin{align}
    \psi_0 = N \left(
        \ee^{-\frac{\lambda_1 r_1}{a_0}}
        \ee^{-\frac{\lambda_2 r_2}{a_0}} + 
        \ee^{-\frac{\lambda_2 r_1}{a_0}}
        \ee^{-\frac{\lambda_1 r_2}{a_0}}
    \right),
\end{align}
变分积分为
\begin{align}
    f(\lambda_1, \lambda_2) = \langle \psi_0 |\hat H | \psi_0 \rangle,
\end{align}
对于 BO 近似下氦原子的电子基态能量进行变分。能量
应当约为 $-2.88\frac{\hbar^2}{ma_0}$。

参考 Eckart, C. Phys. Rev. 36, 878, DOI: 10.1103/PhysRev.36.878
}

那么尝试波函数可以写为
\begin{equation}
    \Phi = \sqrt{\frac{1}{2 (1+c^2)}} \big( \psi_{\zeta_1} (r_1) \psi_{\zeta_2} (r_2) + \psi_{\zeta_2} (r_1) \psi_{\zeta_1} (r_2) \big)
\end{equation}
如果我们定义下述量(注意$ E_H $不是原子单位)：
\begin{equation*}
    E_\mathrm{H} = - \frac{\hbar^2}{2 m a_0^2}, \quad \hat h (r) = - \frac{\hbar^2}{2m} \left( \nabla^2 + \frac{2 Z}{a_0 r} \right)
\end{equation*}
那么原始的 Hamiltonian 可以写为%({\color{red}25\%})
\begin{equation}
    \hat H = \hat h (r_1) + \hat h (r_2) - E_\mathrm{H} \frac{2 a_0}{r_{12}}
\end{equation}
%\tcbline
下面我们要求
$
w = \Braket{\Phi | \hat h (r_1) + \hat h (r_2) - E_\mathrm{H} \frac{2 a_0}{r_{12}} | \Phi }
$

其中一些比较容易给出的积分是
\begin{align}
\langle \psi_\zeta | \hat h | \psi_\zeta \rangle &= \big( 2 Z \zeta - \zeta^2 \big) E_\mathrm{H} \\
\langle \psi_{\zeta_1} | \hat h | \psi_{\zeta_2} \rangle &= c [ Z (\zeta_1 + \zeta_2) - \zeta_1 \zeta_2 ] E_\mathrm{H}
\end{align}




从而，
\begin{align}
    &\quad\ \langle \psi_{\zeta_1} (r_1) \psi_{\zeta_2} (r_2) | \hat h (r_1) + \hat h (r_2) | \psi_{\zeta_1} (r_1) \psi_{\zeta_2} (r_2) \rangle \\
    %&= \langle \psi_{\zeta_1} (r_1) \psi_{\zeta_2} (r_2) | \hat h (r_1) | \psi_{\zeta_1} (r_1) \psi_{\zeta_2} (r_2) \rangle
    %+ \langle \psi_{\zeta_1} (r_1) \psi_{\zeta_2} (r_2) | \hat h (r_2) | \psi_{\zeta_1} (r_1) \psi_{\zeta_2} (r_2) \rangle \\
    &= \langle \psi_{\zeta_1} (r_1) | \hat h (r_1) | \psi_{\zeta_1} (r_1) \rangle \cdot \langle \psi_{\zeta_2} (r_2) | \psi_{\zeta_2} (r_2) \rangle
    + \langle \psi_{\zeta_1} (r_1) | \psi_{\zeta_1} (r_1) \rangle \cdot \langle \psi_{\zeta_2} (r_2) | \hat h (r_2) | \psi_{\zeta_2} (r_2) \rangle \notag\\
    &= \big( 2 Z \zeta_1 - \zeta_1^2 \big) E_\mathrm{H} \cdot 1 + 1 \cdot \big( 2 Z \zeta_2 - \zeta_2^2 \big) E_\mathrm{H} \notag\\
    &= \big( 2 Z \zeta_1 - \zeta_1^2 + 2 Z \zeta_2 - \zeta_2^2 \big) E_\mathrm{H} \\
    &\quad\ \langle \psi_{\zeta_1} (r_1) \psi_{\zeta_2} (r_2) | \hat h (r_1) + \hat h (r_2) | \psi_{\zeta_2} (r_1) \psi_{\zeta_1} (r_2) \rangle \\
    %&= \langle \psi_{\zeta_1} (r_1) \psi_{\zeta_2} (r_2) | \hat h (r_1) | \psi_{\zeta_2} (r_1) \psi_{\zeta_1} (r_2) \rangle
    %+ \langle \psi_{\zeta_1} (r_1) \psi_{\zeta_2} (r_2) | \hat h (r_2) | \psi_{\zeta_2} (r_1) \psi_{\zeta_1} (r_2) \rangle \\
    &= \langle \psi_{\zeta_1} (r_1) | \hat h (r_1) | \psi_{\zeta_2} (r_1) \rangle \cdot \langle \psi_{\zeta_2} (r_2) | \psi_{\zeta_1} (r_2) \rangle
    + \langle \psi_{\zeta_1} (r_1) | \psi_{\zeta_2} (r_1) \rangle \cdot \langle \psi_{\zeta_2} (r_2) | \hat h (r_2) | \psi_{\zeta_1} (r_2) \rangle \notag\\
    %&= c \big( Z (\zeta_1 + \zeta_2) - \zeta_1 \zeta_2 \big) E_\mathrm{H} \cdot c + c \cdot c \big( Z (\zeta_1 + \zeta_2) - \zeta_1 \zeta_2 \big) E_\mathrm{H} \\
    &= 2 c^2 \big( Z (\zeta_1 + \zeta_2) - \zeta_1 \zeta_2 \big) E_\mathrm{H}
\end{align}
这是其中的两项；剩下的两项也是完全相同的。因此，单电子部分的积分为%({\color{red}25\%})
\begin{align}
    \quad\ \langle \Phi | \hat h (r_1) + \hat (h_2) | \Phi \rangle 
    &= \frac{E_\mathrm{H}}{2 (1+c^2)} \cdot 2 \cdot \left[ 2 Z \zeta_1 - \zeta_1^2 + 2 Z \zeta_2 - \zeta_2^2 + 2 c^2 \big( Z (\zeta_1 + \zeta_2) - \zeta_1 \zeta_2 \big) \right] \notag\\
    &= \left[ 2 Z (\zeta_1 + \zeta_2) - \frac{\zeta_1^2 + 2 \zeta_1 \zeta_2 c^2 + \zeta_2^2}{1 + c^2} \right] E_\mathrm{H}
\end{align}
%\tcbline





剩下的部分是关于 $1/r_{12}$ 的积分。对于当前的体系，任何的中心对称波函数 (不含角向部分) $f(r_1, r_2)$ 可以写为下述积分：
\begin{align*}
    \iint  \frac{f(r_1, r_2)}{r_{12}} \, \mathrm{d} \bm{r}_1 \, \mathrm{d} \bm{r}_2 
    &= 4\pi \int_0^{+\infty} r_1^2 \dd r_1 \int_0^{2\pi} \dd\phi_2 \int_0^\pi \sin\theta_2 \dd\theta_2 \int_0^{+\infty}   \dfrac{\dd r_2 \;r_2^2 f(r_1, r_2) }{\sqrt{r_1^2 + r_2^2 - 2r_1 r_2\cos\theta_2}} \notag\\
    &= 4\pi \int_0^{+\infty} r_1^2 \dd r_1  (2\pi)  \int_0^{+\infty}  \dd r_2 r_2^2 f(r_1, r_2) \dfrac{2}{\max(r_1,r_2)} \notag\\
    &= (4 \pi)^2 \int_0^{+\infty} r_1^2 \, \mathrm{d} r_1 
    \qty[\int_0^{r_1} r_2^2 \, \mathrm{d} r_2 \cdot f(r_1, r_2) \frac{1}{r_1}
    + \int_{r_1}^{+\infty} r_2^2 \, \mathrm{d} r_2 \cdot f(r_1, r_2) \frac{1}{r_2}]
\end{align*}
如果 $f(r_1, r_2)$ 是 $\psi_{\zeta_1}^2 (r_1) \psi_{\zeta_2}^2 (r_2)$，那么
\begin{equation*}
    \iint f(r_1, r_2) \frac{1}{r_{12}} \, \mathrm{d} \bm{r}_1 \, \mathrm{d} \bm{r}_2
    = \frac{1}{a_0} \left( \frac{\zeta_1 \zeta_2^3 (4 \zeta_1 + \zeta_2)}{(\zeta_1 + \zeta_2)^4} \right)
    = \frac{1}{a_0} \left( \frac{\zeta_1 \zeta_2}{\zeta_1 + \zeta_2} + \frac{(\zeta_1 \zeta_2)^2}{(\zeta_1 + \zeta_2)^3} \right)
\end{equation*}
如果 $f(r_1, r_2)$ 是 $\psi_{\zeta_1} (r_1) \psi_{\zeta_2} (r_2) \psi_{\zeta_2} (r_1) \psi_{\zeta_1} (r_2)$，那么
\begin{equation*}
    \iint f(r_1, r_2) \frac{1}{r_{12}} \, \mathrm{d} \bm{r}_1 \, \mathrm{d} \bm{r}_2
    = \frac{1}{a_0} \left( \frac{10 (\zeta_1 \zeta_2)^3}{(\zeta_1 + \zeta_2)^5} + \frac{10 (\zeta_1 \zeta_2)^3}{(\zeta_1 + \zeta_2)^5} \right)
    = \frac{1}{a_0} \frac{20 (\zeta_1 \zeta_2)^3}{(\zeta_1 + \zeta_2)^5}
\end{equation*}





对于其它两种情况也是同理的。那么%({\color{red}25\%})
\begin{align*}
    &\quad\ - E_\mathrm{H} \langle \Phi | \frac{2 a_0}{r_{12}} | \Phi \rangle \\
    &= - 2 E_\mathrm{H} a_0 \cdot 2 \cdot \frac{1}{2 (1 + c^2)} \frac{1}{a_0} \left( \frac{\zeta_1 \zeta_2}{\zeta_1 + \zeta_2} + \frac{(\zeta_1 \zeta_2)^2}{(\zeta_1 + \zeta_2)^3} + \frac{20 (\zeta_1 \zeta_2)^3}{(\zeta_1 + \zeta_2)^5} \right) \\
    &= - E_\mathrm{H} \frac{2}{1 + c^2} \left( \frac{\zeta_1 \zeta_2}{\zeta_1 + \zeta_2} + \frac{(\zeta_1 \zeta_2)^2}{(\zeta_1 + \zeta_2)^3} + \frac{20 (\zeta_1 \zeta_2)^3}{(\zeta_1 + \zeta_2)^5} \right)
\end{align*}
%\tcbline




因此，最终的能量总和是
\begin{equation}
    w(\zeta_1, \zeta_2) = \left[ 2 Z (\zeta_1 + \zeta_2) - \frac{\zeta_1^2 + 2 \zeta_1 \zeta_2 c^2 + \zeta_2^2}{1 + c^2} - \frac{2}{1 + c^2} \left( \frac{\zeta_1 \zeta_2}{\zeta_1 + \zeta_2} + \frac{(\zeta_1 \zeta_2)^2}{(\zeta_1 + \zeta_2)^3} + \frac{20 (\zeta_1 \zeta_2)^3}{(\zeta_1 + \zeta_2)^5} \right) \right] E_{\mathrm{H}}
\end{equation}

通过对上述方程求导 $\partial_{\zeta_1} w = \partial_{\zeta_2} = 0$ 可以得到变分极值能量。其中有三个合理的解 ($\zeta_1 > 0, \zeta_2 > 0$ 的情况)%({\color{red}25\%})
：
\begin{gather*}
    \zeta_1 = 1.6875, \zeta_2 = 1.6875 \Rightarrow w = 5.69531 E_\mathrm{H} \\
    \zeta_1 = 2.1832, \zeta_2 = 1.1885 \Rightarrow w = 5.75132 E_\mathrm{H} \\
    \zeta_1 = 1.1885, \zeta_2 = 2.1832 \Rightarrow w = 5.75132 E_\mathrm{H}
\end{gather*}
其中，第二、第三个解是我们需要的，这两个解本身也等价。其化为原子单位是 $-2.87566 $ a.u.。

第一个解恰好是单 $\zeta$ 情形下的变分解。

%\tcbline

%需要注意到，第一个解与基态能量也很接近。我们在线性变分法中提到过，通过该方法得到的次小的能量是体系第一激发态的上界；但这个结论只能在线性变分法中成立，而在普通的 Rayleigh 变分法中不成立。实验的第一激发态与基态之间相差大约 20.62 eV (激发光谱实验数据参考 \url{10.6028/jres.064A.003}{}，基态能量参考 Wikipedia)，这会导致第一激发态能量大约在 $-2.1458$ a.u. 左右。但通过刚才的变分法得到的次小能量是 -2.84766 a.u.，并非第一激发态能量的上界。


\chapter{Misc.}
\section{记号说明}
笔者总是分不清板书中的 psi $\psi$、Psi $\Psi$、phi $\phi$、Phi $\Phi$、varphi $\varphi$，造成内容混乱。因此，希望规定如下，
\begin{table}[ht]
    \centering
    % \caption{Thicker horizontal lines above and below the table.}
    \begin{tabular}[t]{lccc}
    \toprule
    &Text&Commands\\
    \midrule
    波函数 & psi & $\psi$ \\
    二维环的角度 & Phi(phi) & $\Phi(\phi)$ \\
    球面的第二个角度 & Phi(phi) & $\Phi(\phi) $ \\
    极坐标第三个变量 & varphi & $\varphi$ \\
    变分法的波函数 & Phi, phi & $\Phi, \phi$ \\
    \bottomrule
    \end{tabular}
\end{table}%



\section{后记}

灰色背景的代码是 Mathematica，``> >'' 表示输出

本笔记 (更像是课堂实录) 站在巨人的肩膀。

习题解答中，大部分参照了祝震宇、王石嵘的解答。

本课程的历任助教：
\begin{itemize}
    \item 2020：祝震宇、王艺臻
    \item 2021：王石嵘、谭诗乾
    \item 2022：李亚静、范文斌
\end{itemize}

感谢前辈们的付出。

谢谢胡椒柚等同学帮助改进此文档。

~

内容仅供参考。
